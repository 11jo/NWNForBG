IF
	PickPocketFailed([PC])
	Allegiance(Myself,NEUTRAL)
	General(Myself,HUMANOID)
	!StateCheck(Myself,CD_STATE_NOTVALID)
	See(LastTrigger)
	!Allegiance(LastTrigger,FAMILIAR)
THEN
	RESPONSE #100
		StartDialogOverride("NWPICKP",LastTrigger)
END

IF
	PickPocketFailed([FAMILIAR])
	Allegiance(Myself,NEUTRAL)
	General(Myself,HUMANOID)
	!StateCheck(Myself,CD_STATE_NOTVALID)
	See(LastTrigger)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		FaceObject(LastTrigger)
		DisplayStringHead(Myself,@88714)  // ????? ?? ????, ??????? ????????!
		SetSequence(SEQ_ATTACK)
		ApplySpellRES("NWFEAR",LastTrigger)  // No such index
		SetInterrupt(TRUE)
END

IF
	StateCheck(Myself,STATE_REALLY_DEAD)
THEN
	RESPONSE #100
		NoAction()
END

IF
	!HasItem("NWRZDISH",Myself)  // ????
THEN
	RESPONSE #100
		ApplySpellRES("NWRZDISH",Myself)  // No such index
		SetGlobalTimer("PfMW_Timer","LOCALS",0)
		SetGlobalTimer("Invisibility_Timer","LOCALS",0)
		SetGlobalTimer("Mirror_Image_Timer","LOCALS",0)
END

IF
	!Allegiance(Myself,ENEMY)
	OR(12)
		AttackedBy([GOODCUTOFF.0.0.0.0.SUMMONED],DEFAULT)
		AttackedBy([PC],DEFAULT)
		AttackedBy([FAMILIAR],DEFAULT)
		AttackedBy([ALLY],DEFAULT)
		AttackedBy([CONTROLLED],DEFAULT)
		AttackedBy([CHARMED],DEFAULT)
		SpellCastOnMe([GOODCUTOFF.0.0.0.0.SUMMONED],0)
		SpellCastOnMe([PC],0)
		SpellCastOnMe([FAMILIAR],0)
		SpellCastOnMe([ALLY],0)
		SpellCastOnMe([CONTROLLED],0)
		SpellCastOnMe([CHARMED],0)
THEN
	RESPONSE #100
		Enemy()
		Continue()
END

IF
	Global("Dialogue","LOCALS",0)
	See([PC])
	Range([PC],12)
THEN
	RESPONSE #100
		SetGlobal("Dialogue","LOCALS",1)
		StartDialogueNoSet(LastSeenBy(Myself))
END

IF
	Global("Out_of_Spells","LOCALS",0)
	CheckStat(Myself,0,POLYMORPHED)
	!HaveSpell(WIZARD_LARLOCH_MINOR_DRAIN)  // SPWI119.SPL (????? ????????? ???????)
	!HaveSpell(WIZARD_CHARM_PERSON)  // SPWI104.SPL (?????????? ?????????)
	!HaveSpell(WIZARD_BLINDNESS)  // SPWI106.SPL (??????????)
	!HaveSpell(WIZARD_SPOOK)  // SPWI125.SPL (??????????)
	!HaveSpell(WIZARD_GLITTERDUST)  // SPWI224.SPL (?????????? ????)
	!HaveSpell(WIZARD_HORROR)  // SPWI205.SPL (????)
	!HaveSpell(WIZARD_RAY_OF_ENFEEBLEMENT)  // SPWI221.SPL (??? ??????????)
	!HaveSpell(WIZARD_MELF_ACID_ARROW)  // SPWI211.SPL (????????? ?????? ??????)
	!HaveSpell(WIZARD_FLAME_ARROW)  // SPWI303.SPL (????????? ??????)
	!HaveSpell(WIZARD_DIRE_CHARM)  // SPWI316.SPL (??????? ??????????)
	!HaveSpell(WIZARD_HOLD_PERSON)  // SPWI306.SPL (????????? ?????????)
	!HaveSpell(WIZARD_SLOW)  // SPWI312.SPL (??????????)
	!HaveSpell(WIZARD_EMOTION_HOPELESSNESS)  // SPWI411.SPL (??????)
	!HaveSpell(WIZARD_GREATER_MALISON)  // SPWI412.SPL (??????? ?????)
	!HaveSpell(WIZARD_TELEPORT_FIELD)  // SPWI421.SPL (???? ????????????)
	!HaveSpell(WIZARD_CHAOS)  // SPWI508.SPL (????)
	!HaveSpell(WIZARD_DOMINATION)  // SPWI506.SPL (??????????)
	!HaveSpell(WIZARD_FEEBLEMIND)  // SPWI509.SPL (?????????)
	OR(2)
		DifficultyLT(EASY)
		!HaveSpell(WIZARD_SPHERE_OF_CHAOS)  // SPWI711.SPL (????? ?????)
	OR(2)
		DifficultyLT(EASY)
		!HaveSpell(WIZARD_PRISMATIC_SPRAY)  // SPWI714.SPL (???????? ??????)
	OR(2)
		DifficultyLT(NORMAL)
		!HaveSpell(WIZARD_MAZE)  // SPWI813.SPL (????????)
	OR(2)
		DifficultyLT(EASY)
		!HaveSpell(WIZARD_POWER_WORD_STUN)  // SPWI715.SPL (????? ????: ???????????)
	OR(2)
		DifficultyLT(NORMAL)
		!HaveSpell(WIZARD_POWER_WORD_BLIND)  // SPWI815.SPL (????? ????: ??????????)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Spells","LOCALS",1)
END

IF
	Global("Out_of_Area_Spells","LOCALS",0)
	CheckStat(Myself,0,POLYMORPHED)
	!HaveSpell(WIZARD_GLITTERDUST)  // SPWI224.SPL (?????????? ????)
	!HaveSpell(WIZARD_HORROR)  // SPWI205.SPL (????)
	!HaveSpell(WIZARD_SLOW)  // SPWI312.SPL (??????????)
	!HaveSpell(WIZARD_EMOTION_HOPELESSNESS)  // SPWI411.SPL (??????)
	!HaveSpell(WIZARD_GREATER_MALISON)  // SPWI412.SPL (??????? ?????)
	!HaveSpell(WIZARD_TELEPORT_FIELD)  // SPWI421.SPL (???? ????????????)
	!HaveSpell(WIZARD_CHAOS)  // SPWI508.SPL (????)
	OR(2)
		DifficultyLT(EASY)
		!HaveSpell(WIZARD_SPHERE_OF_CHAOS)  // SPWI711.SPL (????? ?????)
	OR(2)
		DifficultyLT(EASY)
		!HaveSpell(WIZARD_PRISMATIC_SPRAY)  // SPWI714.SPL (???????? ??????)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Area_Spells","LOCALS",1)
END

IF
	Global("Out_of_Spells","LOCALS",2)
	DifficultyGT(EASY)
	OR(2)
		HaveSpell(WIZARD_MAZE)  // SPWI813.SPL (????????)
		HaveSpell(WIZARD_POWER_WORD_BLIND)  // SPWI815.SPL (????? ????: ??????????)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Spells","LOCALS",0)
END

IF
	Global("Out_of_Spells","LOCALS",3)
	DifficultyGT(EASIEST)
	OR(5)
		HaveSpell(WIZARD_SPHERE_OF_CHAOS)  // SPWI711.SPL (????? ?????)
		HaveSpell(WIZARD_PRISMATIC_SPRAY)  // SPWI714.SPL (???????? ??????)
		HaveSpell(WIZARD_MAZE)  // SPWI813.SPL (????????)
		HaveSpell(WIZARD_POWER_WORD_STUN)  // SPWI715.SPL (????? ????: ???????????)
		HaveSpell(WIZARD_POWER_WORD_BLIND)  // SPWI815.SPL (????? ????: ??????????)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Spells","LOCALS",0)
END

IF
	Global("Out_of_Area_Spells","LOCALS",3)
	DifficultyGT(EASIEST)
	OR(2)
		HaveSpell(WIZARD_SPHERE_OF_CHAOS)  // SPWI711.SPL (????? ?????)
		HaveSpell(WIZARD_PRISMATIC_SPRAY)  // SPWI714.SPL (???????? ??????)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Area_Spells","LOCALS",0)
END

IF
	OR(2)
		Global("Out_of_Spells","LOCALS",1)
		Global("Out_of_Spells","LOCALS",3)
	Difficulty(EASY)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Spells","LOCALS",2)
END

IF
	OR(2)
		Global("Out_of_Area_Spells","LOCALS",1)
		Global("Out_of_Area_Spells","LOCALS",3)
	Difficulty(EASY)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Area_Spells","LOCALS",2)
END

IF
	OR(2)
		Global("Out_of_Spells","LOCALS",1)
		Global("Out_of_Spells","LOCALS",2)
	Difficulty(EASIEST)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Spells","LOCALS",3)
END

IF
	OR(2)
		Global("Out_of_Area_Spells","LOCALS",1)
		Global("Out_of_Area_Spells","LOCALS",2)
	Difficulty(EASIEST)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Area_Spells","LOCALS",3)
END

IF
	Global("Out_of_Spells","LOCALS",1)
	DifficultyGT(EASY)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Spells","LOCALS",4)
END

IF
	Global("Out_of_Area_Spells","LOCALS",1)
	DifficultyGT(EASY)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Ara_Spells","LOCALS",4)
END

IF
	SpellCast([ENEMY],WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)  // SPWI611.SPL (?????? ?? ??????????? ??????)
THEN
	RESPONSE #100
		SetGlobalTimer("PfMW_Timer","LOCALS",FOUR_ROUNDS)
		Continue()
END

IF
	SpellCast([ENEMY],WIZARD_SPELL_IMMUNITY_DIVINATION)  // SPWI592.SPL (?????????: ??????????)
THEN
	RESPONSE #100
		SetGlobalTimer("Spell_Immunity_Divination","LOCALS",96)
		Continue()
END

IF
	OR(2)
		SpellCast([ENEMY],WIZARD_SHADOW_DOOR)  // SPWI505.SPL (??????? ?????)
		SpellCast([ENEMY],WIZARD_MISLEAD)  // SPWI607.SPL (???????????)
THEN
	RESPONSE #100
		SetGlobalTimer("Invisibility_Timer","LOCALS",96)
		Continue()
END

IF
	SpellCast([ENEMY],WIZARD_MIRROR_IMAGE)  // SPWI212.SPL (?????????? ?????)
THEN
	RESPONSE #100
		SetGlobalTimer("Mirror_Image_Timer","LOCALS",114)
		Continue()
END

IF
	GlobalTimerNotExpired("Mirror_Image_Timer","LOCALS")
	!StateCheck(Myself,STATE_MIRRORIMAGE)
THEN
	RESPONSE #100
		SetGlobalTimer("Mirror_Image_Timer","LOCALS",0)
		Continue()
END

IF
	OR(3)
		SpellCast([GOODCUTOFF],WIZARD_TRUE_SIGHT)  // SPWI609.SPL (???????? ???????)
		SpellCastPriest([GOODCUTOFF],CLERIC_TRUE_SIGHT)  // SPPR505.SPL (???????? ???????)
		SpellCastInnate([GOODCUTOFF],INQUIS_TRUE_SIGHT)  // SPCL232.SPL (???????? ???????)
THEN
	RESPONSE #100
		SetGlobalTimer("PC_True_Sight","LOCALS",ONE_TURN)
		SetGlobalTimer("Invisibility_Timer","LOCALS",0)
		SetGlobalTimer("Mirror_Image_Timer","LOCALS",0)
		Continue()
END

IF
	!GlobalTimerNotExpired("PC_True_Sight","LOCALS")
	GlobalTimerNotExpired("Invisibility_Timer","LOCALS")
	SpellCastInnate([GOODCUTOFF],0)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(Myself,STATE_INVISIBLE)
THEN
	RESPONSE #100
		SetGlobalTimer("PC_True_Sight","LOCALS",ONE_TURN)
		SetGlobalTimer("Invisibility_Timer","LOCALS",0)
		SetGlobalTimer("Mirror_Image_Timer","LOCALS",0)
		Continue()
END

IF
	!GlobalTimerNotExpired("PC_True_Sight","LOCALS")
	GlobalTimerNotExpired("Mirror_Image_Timer","LOCALS")
	SpellCastInnate([GOODCUTOFF],0)
	!StateCheck(Myself,STATE_MIRRORIMAGE)
THEN
	RESPONSE #100
		SetGlobalTimer("PC_True_Sight","LOCALS",ONE_TURN)
		SetGlobalTimer("Invisibility_Timer","LOCALS",0)
		SetGlobalTimer("Mirror_Image_Timer","LOCALS",0)
		Continue()
END

IF
	GlobalTimerNotExpired("PfMW_Timer","LOCALS")
	SpellCastOnMe([GOODCUTOFF],WIZARD_BREACH)  // SPWI513.SPL (??????)
THEN
	RESPONSE #100
		SetGlobalTimer("PfMW_Timer","LOCALS",FOUR_ROUNDS)
		Continue()
END

IF
	!GlobalTimerNotExpired("Spell_Shield_Timer","LOCALS")
	OR(2)
		GlobalTimerNotExpired("Spell_Immunity_Abjuration","LOCALS")
		GlobalTimerNotExpired("Spell_Immunity_Divination","LOCALS")
	!GlobalGT("NWIavecnaplace","GLOBAL",0)
	OR(6)
		SpellCastOnMe([GOODCUTOFF],WIZARD_SPELL_THRUST)  // SPWI321.SPL (?????? ??????????)
		SpellCastOnMe([GOODCUTOFF],WIZARD_SECRET_WORD)  // SPWI419.SPL (?????? ?????)
		SpellCastOnMe([GOODCUTOFF],WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (????????? ??? ??????????)
		SpellCastOnMe([GOODCUTOFF],WIZARD_WARDING_WHIP)  // SPWI705.SPL (??????????????? ????? ???????)
		SpellCastOnMe([GOODCUTOFF],WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (????????? ????)
		SpellCastOnMe([GOODCUTOFF],WIZARD_SPELL_STRIKE)  // SPWI903.SPL (?????? ??????????)
THEN
	RESPONSE #100
		SetGlobalTimer("Spell_Immunity_Abjuration","LOCALS",0)
		SetGlobalTimer("Spell_Immunity_Divination","LOCALS",0)
		Continue()
END

IF
	!GlobalTimerNotExpired("Spell_Shield_Timer","LOCALS")
	GlobalGT("NWIavecnaplace","GLOBAL",0)
	OR(2)
		GlobalTimerNotExpired("Spell_Immunity_Abjuration","LOCALS")
		GlobalTimerNotExpired("Spell_Immunity_Divination","LOCALS")
	SpellCastOnMe([GOODCUTOFF],WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (????????? ??? ??????????)
THEN
	RESPONSE #100
		SetGlobalTimer("Spell_Immunity_Abjuration","LOCALS",0)
		SetGlobalTimer("Spell_Immunity_Divination","LOCALS",0)
		Continue()
END

IF
	Global("PC_Invisibility","LOCALS",0)
	!GlobalTimerNotExpired("True_Sight_Timer","LOCALS")
	OR(10)
		SpellCast([GOODCUTOFF],WIZARD_PROJECT_IMAGE)  // SPWI703.SPL (??????????????? ?????)
		SpellCast([GOODCUTOFF],WIZARD_MASS_INVISIBILITY)  // SPWI721.SPL (???????? ???????????)
		SpellCast([GOODCUTOFF],WIZARD_MISLEAD)  // SPWI607.SPL (???????????)
		SpellCast([GOODCUTOFF],WIZARD_SHADOW_DOOR)  // SPWI505.SPL (??????? ?????)
		SpellCast([GOODCUTOFF],WIZARD_IMPROVED_INVISIBILITY)  // SPWI405.SPL (?????????? ???????????)
		SpellCast([GOODCUTOFF],WIZARD_INVISIBILITY_10_FOOT)  // SPWI307.SPL (????? ???????? ???????????)
		SpellCast([GOODCUTOFF],WIZARD_INVISIBILITY)  // SPWI206.SPL (???????????)
		SpellCast([GOODCUTOFF],WIZARD_MIRROR_IMAGE)  // SPWI212.SPL (?????????? ?????)
		SpellCastPriest([GOODCUTOFF],CLERIC_PIXIE_DUST)  // SPPR516.SPL (??????? ?????)
		SpellCastPriest([GOODCUTOFF],CLERIC_SANCTUARY)  // SPPR109.SPL (?????????)
THEN
	RESPONSE #100
		SetGlobal("PC_Invisibility","LOCALS",1)
		Continue()
END

IF
	Global("Elemental_Attack","LOCALS",0)
	!SpellCastOnMe([GOODCUTOFF],0)
	AttackedBy([GOODCUTOFF],DEFAULT)
	OR(9)
		HitBy([GOODCUTOFF],ACID)
		HitBy([GOODCUTOFF],COLD)
		HitBy([GOODCUTOFF],ELECTRICITY)
		HitBy([GOODCUTOFF],FIRE)
		HitBy([GOODCUTOFF],POISON)
		HitBy([GOODCUTOFF],MAGIC)
		HitBy([GOODCUTOFF],MAGICFIRE)
		HitBy([GOODCUTOFF],MAGICCOLD)
		HitBy([GOODCUTOFF],STUNNING)
THEN
	RESPONSE #100
		SetGlobal("Elemental_Attack","LOCALS",1)
END

IF
	OR(3)
		SpellCast([GOODCUTOFF],WIZARD_TRUE_SIGHT)  // SPWI609.SPL (???????? ???????)
		SpellCastPriest([GOODCUTOFF],CLERIC_TRUE_SIGHT)  // SPPR505.SPL (???????? ???????)
		SpellCastInnate([GOODCUTOFF],INQUIS_TRUE_SIGHT)  // SPCL232.SPL (???????? ???????)
THEN
	RESPONSE #100
		NoAction()
END

IF
	!GlobalTimerNotExpired("PC_True_Sight","LOCALS")
	GlobalTimerNotExpired("Invisibility_Timer","LOCALS")
	SpellCastInnate([GOODCUTOFF],0)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(Myself,STATE_INVISIBLE)
THEN
	RESPONSE #100
		NoAction()
END

IF
	!GlobalTimerNotExpired("PC_True_Sight","LOCALS")
	GlobalTimerNotExpired("Mirror_Image_Timer","LOCALS")
	SpellCastInnate([GOODCUTOFF],0)
	!StateCheck(Myself,STATE_MIRRORIMAGE)
THEN
	RESPONSE #100
		NoAction()
END

IF
	GlobalTimerNotExpired("PfMW_Timer","LOCALS")
	SpellCastOnMe([GOODCUTOFF],WIZARD_BREACH)  // SPWI513.SPL (??????)
THEN
	RESPONSE #100
		NoAction()
END

IF
	!GlobalTimerNotExpired("Spell_Shield_Timer","LOCALS")
	OR(2)
		GlobalTimerNotExpired("Spell_Immunity_Abjuration","LOCALS")
		GlobalTimerNotExpired("Spell_Immunity_Divination","LOCALS")
	!GlobalGT("NWIavecnaplace","GLOBAL",0)
	OR(6)
		SpellCastOnMe([GOODCUTOFF],WIZARD_SPELL_THRUST)  // SPWI321.SPL (?????? ??????????)
		SpellCastOnMe([GOODCUTOFF],WIZARD_SECRET_WORD)  // SPWI419.SPL (?????? ?????)
		SpellCastOnMe([GOODCUTOFF],WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (????????? ??? ??????????)
		SpellCastOnMe([GOODCUTOFF],WIZARD_WARDING_WHIP)  // SPWI705.SPL (??????????????? ????? ???????)
		SpellCastOnMe([GOODCUTOFF],WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (????????? ????)
		SpellCastOnMe([GOODCUTOFF],WIZARD_SPELL_STRIKE)  // SPWI903.SPL (?????? ??????????)
THEN
	RESPONSE #100
		NoAction()
END

IF
	!GlobalTimerNotExpired("Spell_Shield_Timer","LOCALS")
	GlobalGT("NWIavecnaplace","GLOBAL",0)
	OR(2)
		GlobalTimerNotExpired("Spell_Immunity_Abjuration","LOCALS")
		GlobalTimerNotExpired("Spell_Immunity_Divination","LOCALS")
	SpellCastOnMe([GOODCUTOFF],WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (????????? ??? ??????????)
THEN
	RESPONSE #100
		NoAction()
END

IF
	Global("PC_Invisibility","LOCALS",0)
	!GlobalTimerNotExpired("True_Sight_Timer","LOCALS")
	OR(10)
		SpellCast([GOODCUTOFF],WIZARD_PROJECT_IMAGE)  // SPWI703.SPL (??????????????? ?????)
		SpellCast([GOODCUTOFF],WIZARD_MASS_INVISIBILITY)  // SPWI721.SPL (???????? ???????????)
		SpellCast([GOODCUTOFF],WIZARD_MISLEAD)  // SPWI607.SPL (???????????)
		SpellCast([GOODCUTOFF],WIZARD_SHADOW_DOOR)  // SPWI505.SPL (??????? ?????)
		SpellCast([GOODCUTOFF],WIZARD_IMPROVED_INVISIBILITY)  // SPWI405.SPL (?????????? ???????????)
		SpellCast([GOODCUTOFF],WIZARD_INVISIBILITY_10_FOOT)  // SPWI307.SPL (????? ???????? ???????????)
		SpellCast([GOODCUTOFF],WIZARD_INVISIBILITY)  // SPWI206.SPL (???????????)
		SpellCast([GOODCUTOFF],WIZARD_MIRROR_IMAGE)  // SPWI212.SPL (?????????? ?????)
		SpellCastPriest([GOODCUTOFF],CLERIC_PIXIE_DUST)  // SPPR516.SPL (??????? ?????)
		SpellCastPriest([GOODCUTOFF],CLERIC_SANCTUARY)  // SPPR109.SPL (?????????)
THEN
	RESPONSE #100
		NoAction()
END

IF
	Global("Change_AI","LOCALS",0)
	See([ENEMY.0.0.0.0.ILLUSIONARY])
THEN
	RESPONSE #100
		SetGlobal("Change_AI","LOCALS",1)
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("WDRUNSGT",OVERRIDE))
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_VOCALIZE)  // SPWI219.SPL (???????????)
	CheckStat(Myself,0,POLYMORPHED)
	StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_VOCALIZE)  // SPWI219.SPL (???????????)
END

IF
	OR(3)
		!Allegiance(Myself,ENEMY)
		StateCheck(Myself,STATE_DISABLED)
		StateCheck(Myself,STATE_BERSERK)
THEN
	RESPONSE #100
		NoAction()
END

IF
	Global("RZ_See_Enemy","LOCALS",0)
	OR(19)
		See(NearestEnemyOf(Myself))
		AttackedBy([GOODCUTOFF.0.0.0.0.SUMMONED],DEFAULT)
		AttackedBy([PC],DEFAULT)
		AttackedBy([FAMILIAR],DEFAULT)
		AttackedBy([ALLY],DEFAULT)
		AttackedBy([CONTROLLED],DEFAULT)
		AttackedBy([CHARMED],DEFAULT)
		HitBy([GOODCUTOFF.0.0.0.0.SUMMONED],CRUSHING)
		HitBy([PC],CRUSHING)
		HitBy([FAMILIAR],CRUSHING)
		HitBy([ALLY],CRUSHING)
		HitBy([CONTROLLED],CRUSHING)
		HitBy([CHARMED],CRUSHING)
		SpellCastOnMe([GOODCUTOFF.0.0.0.0.SUMMONED],0)
		SpellCastOnMe([PC],0)
		SpellCastOnMe([FAMILIAR],0)
		SpellCastOnMe([ALLY],0)
		SpellCastOnMe([CONTROLLED],0)
		SpellCastOnMe([CHARMED],0)
THEN
	RESPONSE #100
		SetGlobal("RZ_See_Enemy","LOCALS",1)
		Shout(ALERT_100)
END

IF
	Global("RZ_See_Enemy","LOCALS",0)
	Global("RZ_Move_To_PC","LOCALS",0)
THEN
	RESPONSE #100
		RandomWalk()
END

IF
	Global("Out_of_Area_Spells","LOCALS",0)
	!HasItem("NWRZSEEV",Myself)  // ?????????? ??????
	OR(2)
		!GlobalTimerNotExpired("Action_Timer","LOCALS")
		ActionListEmpty()
THEN
	RESPONSE #100
		CreateItem("NWRZSEEV",0,0,0)  // ?????????? ??????
		FillSlot(SLOT_BOOTS)
		Continue()
END

IF
	Global("Out_of_Area_Spells","LOCALS",0)
	Global("No_Target_Available","LOCALS",0)
	HasItem("NWRZSEEV",Myself)  // ?????????? ??????
	See([GOODCUTOFF])
	StateCheck([GOODCUTOFF],STATE_INVISIBLE)
	CheckStat([GOODCUTOFF],0,SANCTUARY)
	CheckStat([GOODCUTOFF],0,SHIELDGLOBE)
	CheckStat([GOODCUTOFF],0,MINORGLOBE)
	See(SecondNearest([GOODCUTOFF]))
	StateCheck(SecondNearest([GOODCUTOFF]),STATE_INVISIBLE)
	CheckStat(SecondNearest([GOODCUTOFF]),0,SANCTUARY)
	CheckStat(SecondNearest([GOODCUTOFF]),0,SHIELDGLOBE)
	CheckStat(SecondNearest([GOODCUTOFF]),0,MINORGLOBE)
	See(ThirdNearest([GOODCUTOFF]))
	StateCheck(ThirdNearest([GOODCUTOFF]),STATE_INVISIBLE)
	CheckStat(ThirdNearest([GOODCUTOFF]),0,SANCTUARY)
	CheckStat(ThirdNearest([GOODCUTOFF]),0,SHIELDGLOBE)
	CheckStat(ThirdNearest([GOODCUTOFF]),0,MINORGLOBE)
	See(FourthNearest([GOODCUTOFF]))
	StateCheck(FourthNearest([GOODCUTOFF]),STATE_INVISIBLE)
	CheckStat(FourthNearest([GOODCUTOFF]),0,SANCTUARY)
	CheckStat(FourthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
	CheckStat(FourthNearest([GOODCUTOFF]),0,MINORGLOBE)
	See(FifthNearest([GOODCUTOFF]))
	StateCheck(FifthNearest([GOODCUTOFF]),STATE_INVISIBLE)
	CheckStat(FifthNearest([GOODCUTOFF]),0,SANCTUARY)
	CheckStat(FifthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
	CheckStat(FifthNearest([GOODCUTOFF]),0,MINORGLOBE)
	See(SixthNearest([GOODCUTOFF]))
	StateCheck(SixthNearest([GOODCUTOFF]),STATE_INVISIBLE)
	CheckStat(SixthNearest([GOODCUTOFF]),0,SANCTUARY)
	CheckStat(SixthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
	CheckStat(SixthNearest([GOODCUTOFF]),0,MINORGLOBE)
	See(SeventhNearest([GOODCUTOFF]))
	StateCheck(SeventhNearest([GOODCUTOFF]),STATE_INVISIBLE)
	CheckStat(SeventhNearest([GOODCUTOFF]),0,SANCTUARY)
	CheckStat(SeventhNearest([GOODCUTOFF]),0,SHIELDGLOBE)
	CheckStat(SeventhNearest([GOODCUTOFF]),0,MINORGLOBE)
	See(EighthNearest([GOODCUTOFF]))
	StateCheck(EighthNearest([GOODCUTOFF]),STATE_INVISIBLE)
	CheckStat(EighthNearest([GOODCUTOFF]),0,SANCTUARY)
	CheckStat(EighthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
	CheckStat(EighthNearest([GOODCUTOFF]),0,MINORGLOBE)
	See(NinthNearest([GOODCUTOFF]))
	StateCheck(NinthNearest([GOODCUTOFF]),STATE_INVISIBLE)
	CheckStat(NinthNearest([GOODCUTOFF]),0,SANCTUARY)
	CheckStat(NinthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
	CheckStat(NinthNearest([GOODCUTOFF]),0,MINORGLOBE)
	See(TenthNearest([GOODCUTOFF]))
	StateCheck(TenthNearest([GOODCUTOFF]),STATE_INVISIBLE)
	CheckStat(TenthNearest([GOODCUTOFF]),0,SANCTUARY)
	CheckStat(TenthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
	CheckStat(TenthNearest([GOODCUTOFF]),0,MINORGLOBE)
THEN
	RESPONSE #100
		SetGlobal("No_Target_Available","LOCALS",1)
END

IF
	Global("No_Target_Available","LOCALS",1)
	See([GOODCUTOFF])
	OR(40)
		!StateCheck([GOODCUTOFF],STATE_INVISIBLE)
		!CheckStat([GOODCUTOFF],0,SANCTUARY)
		!CheckStat([GOODCUTOFF],0,SHIELDGLOBE)
		!CheckStat([GOODCUTOFF],0,MINORGLOBE)
		!StateCheck(SecondNearest([GOODCUTOFF]),STATE_INVISIBLE)
		!CheckStat(SecondNearest([GOODCUTOFF]),0,SANCTUARY)
		!CheckStat(SecondNearest([GOODCUTOFF]),0,SHIELDGLOBE)
		!CheckStat(SecondNearest([GOODCUTOFF]),0,MINORGLOBE)
		!StateCheck(ThirdNearest([GOODCUTOFF]),STATE_INVISIBLE)
		!CheckStat(ThirdNearest([GOODCUTOFF]),0,SANCTUARY)
		!CheckStat(ThirdNearest([GOODCUTOFF]),0,SHIELDGLOBE)
		!CheckStat(ThirdNearest([GOODCUTOFF]),0,MINORGLOBE)
		!StateCheck(FourthNearest([GOODCUTOFF]),STATE_INVISIBLE)
		!CheckStat(FourthNearest([GOODCUTOFF]),0,SANCTUARY)
		!CheckStat(FourthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
		!CheckStat(FourthNearest([GOODCUTOFF]),0,MINORGLOBE)
		!StateCheck(FifthNearest([GOODCUTOFF]),STATE_INVISIBLE)
		!CheckStat(FifthNearest([GOODCUTOFF]),0,SANCTUARY)
		!CheckStat(FifthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
		!CheckStat(FifthNearest([GOODCUTOFF]),0,MINORGLOBE)
		!StateCheck(SixthNearest([GOODCUTOFF]),STATE_INVISIBLE)
		!CheckStat(SixthNearest([GOODCUTOFF]),0,SANCTUARY)
		!CheckStat(SixthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
		!CheckStat(SixthNearest([GOODCUTOFF]),0,MINORGLOBE)
		!StateCheck(SeventhNearest([GOODCUTOFF]),STATE_INVISIBLE)
		!CheckStat(SeventhNearest([GOODCUTOFF]),0,SANCTUARY)
		!CheckStat(SeventhNearest([GOODCUTOFF]),0,SHIELDGLOBE)
		!CheckStat(SeventhNearest([GOODCUTOFF]),0,MINORGLOBE)
		!StateCheck(EighthNearest([GOODCUTOFF]),STATE_INVISIBLE)
		!CheckStat(EighthNearest([GOODCUTOFF]),0,SANCTUARY)
		!CheckStat(EighthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
		!CheckStat(EighthNearest([GOODCUTOFF]),0,MINORGLOBE)
		!StateCheck(NinthNearest([GOODCUTOFF]),STATE_INVISIBLE)
		!CheckStat(NinthNearest([GOODCUTOFF]),0,SANCTUARY)
		!CheckStat(NinthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
		!CheckStat(NinthNearest([GOODCUTOFF]),0,MINORGLOBE)
		!StateCheck(TenthNearest([GOODCUTOFF]),STATE_INVISIBLE)
		!CheckStat(TenthNearest([GOODCUTOFF]),0,SANCTUARY)
		!CheckStat(TenthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
		!CheckStat(TenthNearest([GOODCUTOFF]),0,MINORGLOBE)
THEN
	RESPONSE #100
		SetGlobal("No_Target_Available","LOCALS",0)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_SPELL_IMMUNITY)  // SPWI510.SPL (????????? ? ???????????)
	StateCheck(Myself,STATE_INVISIBLE)
	CheckStat(Myself,0,POLYMORPHED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	Global("No_Target_Available","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		SpellNoDec(Myself,WIZARD_SPELL_IMMUNITY_DIVINATION)  // SPWI592.SPL (?????????: ??????????)
		RemoveSpell(WIZARD_SPELL_IMMUNITY)  // SPWI510.SPL (????????? ? ???????????)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_MISLEAD)  // SPWI607.SPL (???????????)
	OR(2)
		GlobalTimerNotExpired("Spell_Immunity_Divination","LOCALS")
		!GlobalTimerNotExpired("PC_True_Sight","LOCALS")
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(Myself,STATE_INVISIBLE)
	CheckStat(Myself,0,POLYMORPHED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	Global("No_Target_Available","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_MISLEAD)  // SPWI607.SPL (???????????)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)  // SPWI611.SPL (?????? ?? ??????????? ??????)
	!GlobalTimerNotExpired("PfMW_Timer","LOCALS")
	OR(2)
		AttackedBy([GOODCUTOFF],DEFAULT)
		!StateCheck(Myself,STATE_INVISIBLE)
	CheckStat(Myself,0,POLYMORPHED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)  // SPWI611.SPL (?????? ?? ??????????? ??????)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_STONE_SKIN)  // SPWI408.SPL (???????? ????)
	CheckStatLT(Myself,2,STONESKINS)
	!GlobalTimerNotExpired("PfMW_Timer","LOCALS")
	CheckStat(Myself,0,POLYMORPHED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_STONE_SKIN)  // SPWI408.SPL (???????? ????)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_SHADOW_DOOR)  // SPWI505.SPL (??????? ?????)
	OR(2)
		GlobalTimerNotExpired("Spell_Immunity_Divination","LOCALS")
		!GlobalTimerNotExpired("PC_True_Sight","LOCALS")
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(Myself,STATE_INVISIBLE)
	CheckStat(Myself,0,POLYMORPHED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	Global("No_Target_Available","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_SHADOW_DOOR)  // SPWI505.SPL (??????? ?????)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_IMPROVED_INVISIBILITY)  // SPWI405.SPL (?????????? ???????????)
	OR(2)
		GlobalTimerNotExpired("Spell_Immunity_Divination","LOCALS")
		!GlobalTimerNotExpired("PC_True_Sight","LOCALS")
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(Myself,STATE_INVISIBLE)
	CheckStat(Myself,0,POLYMORPHED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	Global("No_Target_Available","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_IMPROVED_INVISIBILITY)  // SPWI405.SPL (?????????? ???????????)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_MIRROR_IMAGE)  // SPWI212.SPL (?????????? ?????)
	!StateCheck(Myself,STATE_MIRRORIMAGE)
	OR(2)
		GlobalTimerNotExpired("Spell_Immunity_Divination","LOCALS")
		!GlobalTimerNotExpired("PC_True_Sight","LOCALS")
	!GlobalTimerNotExpired("PfMW_Timer","LOCALS")
	OR(2)
		AttackedBy([GOODCUTOFF],DEFAULT)
		!StateCheck(Myself,STATE_INVISIBLE)
	OR(2)
		CheckStatLT(Myself,2,STONESKINS)
		Global("Elemental_Attack","LOCALS",1)
	CheckStat(Myself,0,POLYMORPHED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	Global("No_Target_Available","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_MIRROR_IMAGE)  // SPWI212.SPL (?????????? ?????)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_REFLECTED_IMAGE)  // SPWI120.SPL (?????????? ?????)
	!StateCheck(Myself,STATE_MIRRORIMAGE)
	OR(2)
		GlobalTimerNotExpired("Spell_Immunity_Divination","LOCALS")
		!GlobalTimerNotExpired("PC_True_Sight","LOCALS")
	!GlobalTimerNotExpired("PfMW_Timer","LOCALS")
	OR(2)
		AttackedBy([GOODCUTOFF],DEFAULT)
		!StateCheck(Myself,STATE_INVISIBLE)
	OR(2)
		CheckStatLT(Myself,2,STONESKINS)
		Global("Elemental_Attack","LOCALS",1)
	CheckStat(Myself,0,POLYMORPHED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	Global("No_Target_Available","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_REFLECTED_IMAGE)  // SPWI120.SPL (?????????? ?????)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_TRUE_SIGHT)  // SPWI609.SPL (???????? ???????)
	!GlobalTimerNotExpired("True_Sight_Timer","LOCALS")
	OR(32)
		Detect([GOODCUTOFF.0.0.0.0.ILLUSIONARY])
		Global("PC_Invisibility","LOCALS",1)
		StateCheck([GOODCUTOFF],STATE_INVISIBLE)
		StateCheck([GOODCUTOFF],STATE_IMPROVEDINVISIBILITY)
		StateCheck([GOODCUTOFF],STATE_MIRRORIMAGE)
		StateCheck(SecondNearest([GOODCUTOFF]),STATE_INVISIBLE)
		StateCheck(SecondNearest([GOODCUTOFF]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SecondNearest([GOODCUTOFF]),STATE_MIRRORIMAGE)
		StateCheck(ThirdNearest([GOODCUTOFF]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([GOODCUTOFF]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(ThirdNearest([GOODCUTOFF]),STATE_MIRRORIMAGE)
		StateCheck(FourthNearest([GOODCUTOFF]),STATE_INVISIBLE)
		StateCheck(FourthNearest([GOODCUTOFF]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FourthNearest([GOODCUTOFF]),STATE_MIRRORIMAGE)
		StateCheck(FifthNearest([GOODCUTOFF]),STATE_INVISIBLE)
		StateCheck(FifthNearest([GOODCUTOFF]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FifthNearest([GOODCUTOFF]),STATE_MIRRORIMAGE)
		StateCheck(SixthNearest([GOODCUTOFF]),STATE_INVISIBLE)
		StateCheck(SixthNearest([GOODCUTOFF]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SixthNearest([GOODCUTOFF]),STATE_MIRRORIMAGE)
		StateCheck(SeventhNearest([GOODCUTOFF]),STATE_INVISIBLE)
		StateCheck(SeventhNearest([GOODCUTOFF]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SeventhNearest([GOODCUTOFF]),STATE_MIRRORIMAGE)
		StateCheck(EighthNearest([GOODCUTOFF]),STATE_INVISIBLE)
		StateCheck(EighthNearest([GOODCUTOFF]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(EighthNearest([GOODCUTOFF]),STATE_MIRRORIMAGE)
		StateCheck(NinthNearest([GOODCUTOFF]),STATE_INVISIBLE)
		StateCheck(NinthNearest([GOODCUTOFF]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(NinthNearest([GOODCUTOFF]),STATE_MIRRORIMAGE)
		StateCheck(TenthNearest([GOODCUTOFF]),STATE_INVISIBLE)
		StateCheck(TenthNearest([GOODCUTOFF]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(TenthNearest([GOODCUTOFF]),STATE_MIRRORIMAGE)
	CheckStat(Myself,0,POLYMORPHED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		SetGlobal("True_Sight","LOCALS",0)
		Spell(Myself,WIZARD_TRUE_SIGHT)  // SPWI609.SPL (???????? ???????)
END

IF
	Global("No_Target_Available","LOCALS",1)
THEN
	RESPONSE #100
		NoAction()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_PROTECTION_FROM_EVIL)  // SPWI113.SPL (?????? ?? ???)
	Detect([0.0.0.0.0.SUMMONED_DEMON])
	CheckStat(Myself,0,POLYMORPHED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_PROTECTION_FROM_EVIL)  // SPWI113.SPL (?????? ?? ???)
END

IF
	See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_TRUE_DISPEL_MAGIC)  // SPWI326.SPL (??????????? ?????)
	!GlobalTimerNotExpired("Dispel_Timer","LOCALS")
	CheckStat(Myself,0,POLYMORPHED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck([GOODCUTOFF],STATE_DISABLED)
	!StateCheck(SecondNearest([GOODCUTOFF]),STATE_DISABLED)
	!StateCheck(ThirdNearest([GOODCUTOFF]),STATE_DISABLED)
	!StateCheck(FourthNearest([GOODCUTOFF]),STATE_DISABLED)
	!StateCheck(FifthNearest([GOODCUTOFF]),STATE_DISABLED)
	!StateCheck(SixthNearest([GOODCUTOFF]),STATE_DISABLED)
	!StateCheck(SeventhNearest([GOODCUTOFF]),STATE_DISABLED)
	!StateCheck(EighthNearest([GOODCUTOFF]),STATE_DISABLED)
	!StateCheck(NinthNearest([GOODCUTOFF]),STATE_DISABLED)
	!StateCheck(TenthNearest([GOODCUTOFF]),STATE_DISABLED)
	See(NearestEnemyOf(Myself))
	OR(6)
		!See([PC])
		CheckStat([PC],0,STONESKINS)
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_DISABLED)
	OR(6)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,STONESKINS)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(6)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,STONESKINS)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(6)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,STONESKINS)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(6)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,STONESKINS)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,STONESKINS)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(6)
		!See([PC])
		!HasImmunityEffects([PC])
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_DISABLED)
	OR(6)
		!See(SecondNearest([PC]))
		!HasImmunityEffects(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(6)
		!See(ThirdNearest([PC]))
		!HasImmunityEffects(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(6)
		!See(FourthNearest([PC]))
		!HasImmunityEffects(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(6)
		!See(FifthNearest([PC]))
		!HasImmunityEffects(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(6)
		!See(SixthNearest([PC]))
		!HasImmunityEffects(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(6)
		!See([PC])
		!HasBounceEffects([PC])
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_DISABLED)
	OR(6)
		!See(SecondNearest([PC]))
		!HasBounceEffects(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(6)
		!See(ThirdNearest([PC]))
		!HasBounceEffects(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(6)
		!See(FourthNearest([PC]))
		!HasBounceEffects(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(6)
		!See(FifthNearest([PC]))
		!HasBounceEffects(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(6)
		!See(SixthNearest([PC]))
		!HasBounceEffects(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(6)
		!See([PC])
		!StateCheck([PC],RZ_STATE_DISPEL)
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_DISABLED)
	OR(6)
		!See(SecondNearest([PC]))
		!StateCheck(SecondNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(6)
		!See(ThirdNearest([PC]))
		!StateCheck(ThirdNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(6)
		!See(FourthNearest([PC]))
		!StateCheck(FourthNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(6)
		!See(FifthNearest([PC]))
		!StateCheck(FifthNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(6)
		!See(SixthNearest([PC]))
		!StateCheck(SixthNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(5)
		!See([PC])
		CheckStat([PC],0,STONESKINS)
		StateCheck([PC],STATE_INVISIBLE)
		!StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		StateCheck([PC],STATE_DISABLED)
	OR(5)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,STONESKINS)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(5)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,STONESKINS)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		!StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(5)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,STONESKINS)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,STONESKINS)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(5)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,STONESKINS)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(5)
		!See([PC])
		!HasImmunityEffects([PC])
		StateCheck([PC],STATE_INVISIBLE)
		!StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		StateCheck([PC],STATE_DISABLED)
	OR(5)
		!See(SecondNearest([PC]))
		!HasImmunityEffects(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(5)
		!See(ThirdNearest([PC]))
		!HasImmunityEffects(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		!StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(5)
		!See(FourthNearest([PC]))
		!HasImmunityEffects(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(5)
		!See(FifthNearest([PC]))
		!HasImmunityEffects(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(5)
		!See(SixthNearest([PC]))
		!HasImmunityEffects(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(5)
		!See([PC])
		!HasBounceEffects([PC])
		StateCheck([PC],STATE_INVISIBLE)
		!StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		StateCheck([PC],STATE_DISABLED)
	OR(5)
		!See(SecondNearest([PC]))
		!HasBounceEffects(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(5)
		!See(ThirdNearest([PC]))
		!HasBounceEffects(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		!StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(5)
		!See(FourthNearest([PC]))
		!HasBounceEffects(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(5)
		!See(FifthNearest([PC]))
		!HasBounceEffects(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(5)
		!See(SixthNearest([PC]))
		!HasBounceEffects(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(5)
		!See([PC])
		!StateCheck([PC],RZ_STATE_DISPEL)
		StateCheck([PC],STATE_INVISIBLE)
		!StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		StateCheck([PC],STATE_DISABLED)
	OR(5)
		!See(SecondNearest([PC]))
		!StateCheck(SecondNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(5)
		!See(ThirdNearest([PC]))
		!StateCheck(ThirdNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		!StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(5)
		!See(FourthNearest([PC]))
		!StateCheck(FourthNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(5)
		!See(FifthNearest([PC]))
		!StateCheck(FifthNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(5)
		!See(SixthNearest([PC]))
		!StateCheck(SixthNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See([PC])
		CheckStat([PC],0,STONESKINS)
		CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,STONESKINS)
		CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,STONESKINS)
		CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,STONESKINS)
		CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,STONESKINS)
		CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,STONESKINS)
		CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See([PC])
		!HasImmunityEffects([PC])
		CheckStat(Nearest([PC]),0,SANCTUARY)
		StateCheck([PC],STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		!HasImmunityEffects(SecondNearest([PC]))
		CheckStat(Nearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		!HasImmunityEffects(ThirdNearest([PC]))
		CheckStat(Nearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		!HasImmunityEffects(FourthNearest([PC]))
		CheckStat(Nearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		!HasImmunityEffects(FifthNearest([PC]))
		CheckStat(Nearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		!HasImmunityEffects(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See([PC])
		!StateCheck([PC],RZ_STATE_DISPEL)
		CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		!StateCheck(SecondNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		!StateCheck(ThirdNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		!StateCheck(FourthNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		!StateCheck(FifthNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		!StateCheck(SixthNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See([PC])
		CheckStat([PC],0,STONESKINS)
		CheckStat([PC],0,SHIELDGLOBE)
		StateCheck([PC],STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,STONESKINS)
		CheckStat(SecondNearest([PC]),0,SHIELDGLOBE)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,STONESKINS)
		CheckStat(ThirdNearest([PC]),0,SHIELDGLOBE)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,STONESKINS)
		CheckStat(FourthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,STONESKINS)
		CheckStat(FifthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,STONESKINS)
		CheckStat(SixthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See([PC])
		!HasImmunityEffects([PC])
		CheckStat(Nearest([PC]),0,SHIELDGLOBE)
		StateCheck([PC],STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		!HasImmunityEffects(SecondNearest([PC]))
		CheckStat(Nearest([PC]),0,SHIELDGLOBE)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		!HasImmunityEffects(ThirdNearest([PC]))
		CheckStat(Nearest([PC]),0,SHIELDGLOBE)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		!HasImmunityEffects(FourthNearest([PC]))
		CheckStat(Nearest([PC]),0,SHIELDGLOBE)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		!HasImmunityEffects(FifthNearest([PC]))
		CheckStat(Nearest([PC]),0,SHIELDGLOBE)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		!HasImmunityEffects(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See([PC])
		!StateCheck([PC],RZ_STATE_DISPEL)
		CheckStat([PC],0,SHIELDGLOBE)
		StateCheck([PC],STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		!StateCheck(SecondNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(SecondNearest([PC]),0,SHIELDGLOBE)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		!StateCheck(ThirdNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(ThirdNearest([PC]),0,SHIELDGLOBE)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		!StateCheck(FourthNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(FourthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		!StateCheck(FifthNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(FifthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		!StateCheck(SixthNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(SixthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(3)
		!See([PC])
		!HasBounceEffects([PC])
		StateCheck([PC],STATE_DISABLED)
	OR(3)
		!See(SecondNearest([PC]))
		!HasBounceEffects(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(ThirdNearest([PC]))
		!HasBounceEffects(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(FourthNearest([PC]))
		!HasBounceEffects(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(FifthNearest([PC]))
		!HasBounceEffects(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(SixthNearest([PC]))
		!HasBounceEffects(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See([PC])
		CheckStat([PC],0,STONESKINS)
		CheckStat([PC],0,MINORGLOBE)
		StateCheck([PC],STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,STONESKINS)
		CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,STONESKINS)
		CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,STONESKINS)
		CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,STONESKINS)
		CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,STONESKINS)
		CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See([PC])
		!HasImmunityEffects([PC])
		CheckStat(Nearest([PC]),0,MINORGLOBE)
		StateCheck([PC],STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		!HasImmunityEffects(SecondNearest([PC]))
		CheckStat(Nearest([PC]),0,MINORGLOBE)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		!HasImmunityEffects(ThirdNearest([PC]))
		CheckStat(Nearest([PC]),0,MINORGLOBE)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		!HasImmunityEffects(FourthNearest([PC]))
		CheckStat(Nearest([PC]),0,MINORGLOBE)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		!HasImmunityEffects(FifthNearest([PC]))
		CheckStat(Nearest([PC]),0,MINORGLOBE)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		!HasImmunityEffects(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See([PC])
		!StateCheck([PC],RZ_STATE_DISPEL)
		CheckStat([PC],0,MINORGLOBE)
		StateCheck([PC],STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		!StateCheck(SecondNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		!StateCheck(ThirdNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		!StateCheck(FourthNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		!StateCheck(FifthNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		!StateCheck(SixthNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_TRUE_DISPEL_MAGIC)  // SPWI326.SPL (??????????? ?????)
	!GlobalTimerNotExpired("Dispel_Timer","LOCALS")
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!StateCheck([GOODCUTOFF],STATE_DISABLED)
	!StateCheck(SecondNearest([GOODCUTOFF]),STATE_DISABLED)
	!StateCheck(ThirdNearest([GOODCUTOFF]),STATE_DISABLED)
	!StateCheck(FourthNearest([GOODCUTOFF]),STATE_DISABLED)
	!StateCheck(FifthNearest([GOODCUTOFF]),STATE_DISABLED)
	!StateCheck(SixthNearest([GOODCUTOFF]),STATE_DISABLED)
	!StateCheck(SeventhNearest([GOODCUTOFF]),STATE_DISABLED)
	!StateCheck(EighthNearest([GOODCUTOFF]),STATE_DISABLED)
	!StateCheck(NinthNearest([GOODCUTOFF]),STATE_DISABLED)
	!StateCheck(TenthNearest([GOODCUTOFF]),STATE_DISABLED)
	See(LastSeenBy(Myself))
	OR(5)
		!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		!CheckStat(LastSeenBy(Myself),0,SANCTUARY)
		!CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
		HasBounceEffects(LastSeenBy(Myself))
		!CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!Allegiance(LastSeenBy(Myself),ENEMY)
	OR(4)
		StateCheck(LastSeenBy(Myself),RZ_STATE_DISPEL)
		!CheckStat(LastSeenBy(Myself),0,STONESKINS)
		HasBounceEffects(LastSeenBy(Myself))
		HasImmunityEffects(LastSeenBy(Myself))
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		SetGlobalTimer("Dispel_Timer","LOCALS",ONE_TURN)
		Spell(LastSeenBy(Myself),WIZARD_TRUE_DISPEL_MAGIC)  // SPWI326.SPL (??????????? ?????)
	RESPONSE #50
		SetGlobalTimer("Dispel_Timer","LOCALS",ONE_ROUND)
		Continue()
END

IF
	See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	Global("Out_of_Spells","LOCALS",0)
	CheckStat(Myself,0,POLYMORPHED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	OR(8)
		RandomNumGT(100,33)
		!See(LastAttackerOf(Myself))
		StateCheck(LastAttackerOf(Myself),STATE_INVISIBLE)
		StateCheck(LastAttackerOf(Myself),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(LastAttackerOf(Myself),0,SANCTUARY)
		StateCheck(LastAttackerOf(Myself),STATE_DISABLED)
		HasBounceEffects(LastAttackerOf(Myself))
		HasImmunityEffects(LastAttackerOf(Myself))
	OR(8)
		RandomNumGT(100,33)
		!See(MostDamagedOf([PC]))
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		StateCheck(MostDamagedOf([PC]),STATE_DISABLED)
		HasBounceEffects(MostDamagedOf([PC]))
		HasImmunityEffects(MostDamagedOf([PC]))
	OR(8)
		RandomNumGT(100,33)
		!See(WeakestOf([PC]))
		StateCheck(WeakestOf([PC]),STATE_INVISIBLE)
		StateCheck(WeakestOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(WeakestOf([PC]),0,SANCTUARY)
		StateCheck(WeakestOf([PC]),STATE_DISABLED)
		HasBounceEffects(WeakestOf([PC]))
		HasImmunityEffects(WeakestOf([PC]))
	OR(8)
		RandomNumGT(100,33)
		!See(StrongestOf([PC]))
		StateCheck(StrongestOf([PC]),STATE_INVISIBLE)
		StateCheck(StrongestOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(StrongestOf([PC]),0,SANCTUARY)
		StateCheck(StrongestOf([PC]),STATE_DISABLED)
		HasBounceEffects(StrongestOf([PC]))
		HasImmunityEffects(StrongestOf([PC]))
	OR(8)
		RandomNumGT(100,25)
		!See([PC])
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_DISABLED)
		HasBounceEffects([PC])
		HasImmunityEffects([PC])
	OR(8)
		RandomNumGT(100,46)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
		HasBounceEffects(SecondNearest([PC]))
		HasImmunityEffects(SecondNearest([PC]))
	OR(8)
		RandomNumGT(100,63)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
		HasBounceEffects(ThirdNearest([PC]))
		HasImmunityEffects(ThirdNearest([PC]))
	OR(8)
		RandomNumGT(100,76)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
		HasBounceEffects(FourthNearest([PC]))
		HasImmunityEffects(FourthNearest([PC]))
	OR(8)
		RandomNumGT(100,85)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
		HasBounceEffects(FifthNearest([PC]))
		HasImmunityEffects(FifthNearest([PC]))
	OR(8)
		RandomNumGT(100,90)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
		HasBounceEffects(SixthNearest([PC]))
		HasImmunityEffects(SixthNearest([PC]))
	OR(7)
		RandomNumGT(100,33)
		!See(MostDamagedOf([PC]))
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		HasBounceEffects(MostDamagedOf([PC]))
		HasImmunityEffects(MostDamagedOf([PC]))
	OR(7)
		RandomNumGT(100,33)
		!See(WeakestOf([PC]))
		StateCheck(WeakestOf([PC]),STATE_INVISIBLE)
		StateCheck(WeakestOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(WeakestOf([PC]),0,SANCTUARY)
		HasBounceEffects(WeakestOf([PC]))
		HasImmunityEffects(WeakestOf([PC]))
	OR(7)
		RandomNumGT(100,33)
		!See(StrongestOf([PC]))
		StateCheck(StrongestOf([PC]),STATE_INVISIBLE)
		StateCheck(StrongestOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(StrongestOf([PC]),0,SANCTUARY)
		HasBounceEffects(StrongestOf([PC]))
		HasImmunityEffects(StrongestOf([PC]))
	OR(7)
		RandomNumGT(100,25)
		!See([PC])
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
		HasBounceEffects([PC])
		HasImmunityEffects([PC])
	OR(7)
		RandomNumGT(100,46)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		HasBounceEffects(SecondNearest([PC]))
		HasImmunityEffects(SecondNearest([PC]))
	OR(7)
		RandomNumGT(100,63)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		HasBounceEffects(ThirdNearest([PC]))
		HasImmunityEffects(ThirdNearest([PC]))
	OR(7)
		RandomNumGT(100,76)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		HasBounceEffects(FourthNearest([PC]))
		HasImmunityEffects(FourthNearest([PC]))
	OR(7)
		RandomNumGT(100,85)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		HasBounceEffects(FifthNearest([PC]))
		HasImmunityEffects(FifthNearest([PC]))
	OR(7)
		RandomNumGT(100,90)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		HasBounceEffects(SixthNearest([PC]))
		HasImmunityEffects(SixthNearest([PC]))
	OR(6)
		RandomNumGT(100,33)
		!See(MostDamagedOf([PC]))
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		StateCheck(MostDamagedOf([PC]),STATE_DISABLED)
	OR(6)
		RandomNumGT(100,33)
		!See(WeakestOf([PC]))
		StateCheck(WeakestOf([PC]),STATE_INVISIBLE)
		StateCheck(WeakestOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(WeakestOf([PC]),0,SANCTUARY)
		StateCheck(WeakestOf([PC]),STATE_DISABLED)
	OR(6)
		RandomNumGT(100,33)
		!See(StrongestOf([PC]))
		StateCheck(StrongestOf([PC]),STATE_INVISIBLE)
		StateCheck(StrongestOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(StrongestOf([PC]),0,SANCTUARY)
		StateCheck(StrongestOf([PC]),STATE_DISABLED)
	OR(6)
		RandomNumGT(100,25)
		!See([PC])
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_DISABLED)
	OR(6)
		RandomNumGT(100,46)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(6)
		RandomNumGT(100,63)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(6)
		RandomNumGT(100,76)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(6)
		RandomNumGT(100,85)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(6)
		RandomNumGT(100,90)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(5)
		RandomNumGT(100,33)
		!See(MostDamagedOf([PC]))
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
	OR(5)
		RandomNumGT(100,33)
		!See(WeakestOf([PC]))
		StateCheck(WeakestOf([PC]),STATE_INVISIBLE)
		StateCheck(WeakestOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(WeakestOf([PC]),0,SANCTUARY)
	OR(5)
		RandomNumGT(100,33)
		!See(StrongestOf([PC]))
		StateCheck(StrongestOf([PC]),STATE_INVISIBLE)
		StateCheck(StrongestOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(StrongestOf([PC]),0,SANCTUARY)
	OR(5)
		RandomNumGT(100,25)
		!See([PC])
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
	OR(5)
		RandomNumGT(100,46)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(5)
		RandomNumGT(100,63)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(5)
		RandomNumGT(100,76)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(5)
		RandomNumGT(100,85)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(5)
		RandomNumGT(100,90)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(4)
		!See(MostDamagedOf([PC]))
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
	OR(4)
		!See(WeakestOf([PC]))
		StateCheck(WeakestOf([PC]),STATE_INVISIBLE)
		StateCheck(WeakestOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(WeakestOf([PC]),0,SANCTUARY)
	OR(4)
		!See(StrongestOf([PC]))
		StateCheck(StrongestOf([PC]),STATE_INVISIBLE)
		StateCheck(StrongestOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(StrongestOf([PC]),0,SANCTUARY)
	OR(4)
		!See([PC])
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
	OR(4)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(4)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(4)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(4)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(4)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(4)
		!See(MostDamagedOf([PC]))
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		!StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(MostDamagedOf([PC]),STATE_DISABLED)
	OR(4)
		!See(WeakestOf([PC]))
		StateCheck(WeakestOf([PC]),STATE_INVISIBLE)
		!StateCheck(WeakestOf([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(WeakestOf([PC]),STATE_DISABLED)
	OR(4)
		!See(StrongestOf([PC]))
		StateCheck(StrongestOf([PC]),STATE_INVISIBLE)
		!StateCheck(StrongestOf([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(StrongestOf([PC]),STATE_DISABLED)
	OR(4)
		!See([PC])
		StateCheck([PC],STATE_INVISIBLE)
		!StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		StateCheck([PC],STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		!StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(MostDamagedOf([PC]))
		CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		StateCheck(MostDamagedOf([PC]),STATE_DISABLED)
	OR(3)
		!See(WeakestOf([PC]))
		CheckStat(WeakestOf([PC]),0,SANCTUARY)
		StateCheck(WeakestOf([PC]),STATE_DISABLED)
	OR(3)
		!See(StrongestOf([PC]))
		CheckStat(StrongestOf([PC]),0,SANCTUARY)
		StateCheck(StrongestOf([PC]),STATE_DISABLED)
	OR(3)
		!See([PC])
		CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_DISABLED)
	OR(3)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(MostDamagedOf([PC]))
		CheckStat(MostDamagedOf([PC]),0,SHIELDGLOBE)
		StateCheck(MostDamagedOf([PC]),STATE_DISABLED)
	OR(3)
		!See(WeakestOf([PC]))
		CheckStat(WeakestOf([PC]),0,SHIELDGLOBE)
		StateCheck(WeakestOf([PC]),STATE_DISABLED)
	OR(3)
		!See(StrongestOf([PC]))
		CheckStat(StrongestOf([PC]),0,SHIELDGLOBE)
		StateCheck(StrongestOf([PC]),STATE_DISABLED)
	OR(3)
		!See([PC])
		CheckStat([PC],0,SHIELDGLOBE)
		StateCheck([PC],STATE_DISABLED)
	OR(3)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,SHIELDGLOBE)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,SHIELDGLOBE)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(MostDamagedOf([PC]))
		!HasBounceEffects(MostDamagedOf([PC]))
		StateCheck(MostDamagedOf([PC]),STATE_DISABLED)
	OR(3)
		!See(WeakestOf([PC]))
		!HasBounceEffects(WeakestOf([PC]))
		StateCheck(WeakestOf([PC]),STATE_DISABLED)
	OR(3)
		!See(StrongestOf([PC]))
		!HasBounceEffects(StrongestOf([PC]))
		StateCheck(StrongestOf([PC]),STATE_DISABLED)
	OR(3)
		!See([PC])
		!HasBounceEffects([PC])
		StateCheck([PC],STATE_DISABLED)
	OR(3)
		!See(SecondNearest([PC]))
		!HasBounceEffects(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(ThirdNearest([PC]))
		!HasBounceEffects(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(FourthNearest([PC]))
		!HasBounceEffects(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(FifthNearest([PC]))
		!HasBounceEffects(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(SixthNearest([PC]))
		!HasBounceEffects(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(MostDamagedOf([PC]))
		CheckStat(MostDamagedOf([PC]),0,MINORGLOBE)
		StateCheck(MostDamagedOf([PC]),STATE_DISABLED)
	OR(3)
		!See(WeakestOf([PC]))
		CheckStat(WeakestOf([PC]),0,MINORGLOBE)
		StateCheck(WeakestOf([PC]),STATE_DISABLED)
	OR(3)
		!See(StrongestOf([PC]))
		CheckStat(StrongestOf([PC]),0,MINORGLOBE)
		StateCheck(StrongestOf([PC]),STATE_DISABLED)
	OR(3)
		!See([PC])
		CheckStat([PC],0,MINORGLOBE)
		StateCheck([PC],STATE_DISABLED)
	OR(3)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(3)
		!See(MostDamagedOf([PC]))
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		!StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
	OR(3)
		!See(WeakestOf([PC]))
		StateCheck(WeakestOf([PC]),STATE_INVISIBLE)
		!StateCheck(WeakestOf([PC]),STATE_IMPROVEDINVISIBILITY)
	OR(3)
		!See(StrongestOf([PC]))
		StateCheck(StrongestOf([PC]),STATE_INVISIBLE)
		!StateCheck(StrongestOf([PC]),STATE_IMPROVEDINVISIBILITY)
	OR(3)
		!See([PC])
		StateCheck([PC],STATE_INVISIBLE)
		!StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
	OR(3)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
	OR(3)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		!StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
	OR(3)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
	OR(3)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
	OR(3)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!See(MostDamagedOf([PC]))
		CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
	OR(2)
		!See(WeakestOf([PC]))
		CheckStat(WeakestOf([PC]),0,SANCTUARY)
	OR(2)
		!See(StrongestOf([PC]))
		CheckStat(StrongestOf([PC]),0,SANCTUARY)
	OR(2)
		!See([PC])
		CheckStat([PC],0,SANCTUARY)
	OR(2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(2)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(2)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(2)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(2)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(2)
		!See(MostDamagedOf([PC]))
		CheckStat(MostDamagedOf([PC]),0,SHIELDGLOBE)
	OR(2)
		!See(WeakestOf([PC]))
		CheckStat(WeakestOf([PC]),0,SHIELDGLOBE)
	OR(2)
		!See(StrongestOf([PC]))
		CheckStat(StrongestOf([PC]),0,SHIELDGLOBE)
	OR(2)
		!See([PC])
		CheckStat([PC],0,SHIELDGLOBE)
	OR(2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,SHIELDGLOBE)
	OR(2)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,SHIELDGLOBE)
	OR(2)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,SHIELDGLOBE)
	OR(2)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,SHIELDGLOBE)
	OR(2)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,SHIELDGLOBE)
	OR(2)
		!See(MostDamagedOf([PC]))
		!HasBounceEffects(MostDamagedOf([PC]))
	OR(2)
		!See(WeakestOf([PC]))
		!HasBounceEffects(WeakestOf([PC]))
	OR(2)
		!See(StrongestOf([PC]))
		!HasBounceEffects(StrongestOf([PC]))
	OR(2)
		!See([PC])
		!HasBounceEffects([PC])
	OR(2)
		!See(SecondNearest([PC]))
		!HasBounceEffects(SecondNearest([PC]))
	OR(2)
		!See(ThirdNearest([PC]))
		!HasBounceEffects(ThirdNearest([PC]))
	OR(2)
		!See(FourthNearest([PC]))
		!HasBounceEffects(FourthNearest([PC]))
	OR(2)
		!See(FifthNearest([PC]))
		!HasBounceEffects(FifthNearest([PC]))
	OR(2)
		!See(SixthNearest([PC]))
		!HasBounceEffects(SixthNearest([PC]))
	OR(2)
		!See(MostDamagedOf([PC]))
		CheckStat(MostDamagedOf([PC]),0,MINORGLOBE)
	OR(2)
		!See(WeakestOf([PC]))
		CheckStat(WeakestOf([PC]),0,MINORGLOBE)
	OR(2)
		!See(StrongestOf([PC]))
		CheckStat(StrongestOf([PC]),0,MINORGLOBE)
	OR(2)
		!See([PC])
		CheckStat([PC],0,MINORGLOBE)
	OR(2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,MINORGLOBE)
	OR(2)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
	OR(2)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,MINORGLOBE)
	OR(2)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,MINORGLOBE)
	OR(2)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,MINORGLOBE)
	OR(6)
		!See(NearestEnemyOf(Myself))
		StateCheck(NearestEnemyOf(Myself),STATE_INVISIBLE)
		!CheckStat(NearestEnemyOf(Myself),0,SANCTUARY)
		StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
		HasBounceEffects(NearestEnemyOf(Myself))
		HasImmunityEffects(NearestEnemyOf(Myself))
	OR(6)
		!See(SecondNearestEnemyOf(Myself))
		StateCheck(SecondNearestEnemyOf(Myself),STATE_INVISIBLE)
		!CheckStat(SecondNearestEnemyOf(Myself),0,SANCTUARY)
		StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
		HasBounceEffects(SecondNearestEnemyOf(Myself))
		HasImmunityEffects(SecondNearestEnemyOf(Myself))
	OR(6)
		!See(ThirdNearestEnemyOf(Myself))
		StateCheck(ThirdNearestEnemyOf(Myself),STATE_INVISIBLE)
		!CheckStat(ThirdNearestEnemyOf(Myself),0,SANCTUARY)
		StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
		HasBounceEffects(ThirdNearestEnemyOf(Myself))
		HasImmunityEffects(ThirdNearestEnemyOf(Myself))
	OR(6)
		!See(FourthNearestEnemyOf(Myself))
		StateCheck(FourthNearestEnemyOf(Myself),STATE_INVISIBLE)
		!CheckStat(FourthNearestEnemyOf(Myself),0,SANCTUARY)
		StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
		HasBounceEffects(FourthNearestEnemyOf(Myself))
		HasImmunityEffects(FourthNearestEnemyOf(Myself))
	OR(6)
		!See(FifthNearestEnemyOf(Myself))
		StateCheck(FifthNearestEnemyOf(Myself),STATE_INVISIBLE)
		!CheckStat(FifthNearestEnemyOf(Myself),0,SANCTUARY)
		StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
		HasBounceEffects(FifthNearestEnemyOf(Myself))
		HasImmunityEffects(FifthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_SLOW)  // SPWI312.SPL (??????????)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	StateCheck(LastSeenBy(Myself),STATE_HASTED)
	Range(LastSeenBy(Myself),12)
	OR(2)
		NumCreatureGT([GOODCUTOFF],1)
		CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(5)
		!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		!CheckStat(LastSeenBy(Myself),0,SANCTUARY)
		!CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
		HasBounceEffects(LastSeenBy(Myself))
		!CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_SLOW)  // SPWI312.SPL (??????????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_POWER_WORD_BLIND)  // SPWI815.SPL (????? ????: ??????????)
	DifficultyGT(EASY)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	!Range(LastSeenBy(Myself),12)
	!StateCheck(LastSeenBy(Myself),STATE_BLIND)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		DestroyItem("NWRZSEEV")  // ?????????? ??????
		Spell(LastSeenBy(Myself),WIZARD_POWER_WORD_BLIND)  // SPWI815.SPL (????? ????: ??????????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_POWER_WORD_STUN)  // SPWI715.SPL (????? ????: ???????????)
	DifficultyGT(EASIEST)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	HPPercentLT(LastSeenBy(Myself),60)
	CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		DestroyItem("NWRZSEEV")  // ?????????? ??????
		Spell(LastSeenBy(Myself),WIZARD_POWER_WORD_STUN)  // SPWI715.SPL (????? ????: ???????????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_GREATER_MALISON)  // SPWI412.SPL (??????? ?????)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(2)
		NumCreatureGT([GOODCUTOFF],1)
		CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(5)
		!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		!CheckStat(LastSeenBy(Myself),0,SANCTUARY)
		!CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
		HasBounceEffects(LastSeenBy(Myself))
		!CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_GREATER_MALISON)  // SPWI412.SPL (??????? ?????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_SPHERE_OF_CHAOS)  // SPWI711.SPL (????? ?????)
	DifficultyGT(EASIEST)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(5)
		!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		!CheckStat(LastSeenBy(Myself),0,SANCTUARY)
		!CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
		HasBounceEffects(LastSeenBy(Myself))
		!CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_SPHERE_OF_CHAOS)  // SPWI711.SPL (????? ?????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_SLOW)  // SPWI312.SPL (??????????)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(2)
		NumCreatureGT([GOODCUTOFF],1)
		CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(5)
		!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		!CheckStat(LastSeenBy(Myself),0,SANCTUARY)
		!CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
		HasBounceEffects(LastSeenBy(Myself))
		!CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_SLOW)  // SPWI312.SPL (??????????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_GLITTERDUST)  // SPWI224.SPL (?????????? ????)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(2)
		NumCreatureGT([GOODCUTOFF],1)
		CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(5)
		!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		!CheckStat(LastSeenBy(Myself),0,SANCTUARY)
		!CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
		HasBounceEffects(LastSeenBy(Myself))
		!CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_GLITTERDUST)  // SPWI224.SPL (?????????? ????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_CHAOS)  // SPWI508.SPL (????)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(2)
		NumCreatureGT([GOODCUTOFF],1)
		CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	OR(5)
		!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		!CheckStat(LastSeenBy(Myself),0,SANCTUARY)
		!CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
		HasBounceEffects(LastSeenBy(Myself))
		!CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(2)
		!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
		NumCreatureGT([GOODCUTOFF],1)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_CHAOS)  // SPWI508.SPL (????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_TELEPORT_FIELD)  // SPWI421.SPL (???? ????????????)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(2)
		NumCreatureGT([GOODCUTOFF],1)
		CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(5)
		!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		!CheckStat(LastSeenBy(Myself),0,SANCTUARY)
		!CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
		HasBounceEffects(LastSeenBy(Myself))
		!CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_TELEPORT_FIELD)  // SPWI421.SPL (???? ????????????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_PRISMATIC_SPRAY)  // SPWI714.SPL (???????? ??????)
	DifficultyGT(EASIEST)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(5)
		!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		!CheckStat(LastSeenBy(Myself),0,SANCTUARY)
		!CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
		HasBounceEffects(LastSeenBy(Myself))
		!CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_PRISMATIC_SPRAY)  // SPWI714.SPL (???????? ??????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_MAZE)  // SPWI813.SPL (????????)
	DifficultyGT(EASY)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	Range(LastSeenBy(Myself),8)
	CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		DestroyItem("NWRZSEEV")  // ?????????? ??????
		Spell(LastSeenBy(Myself),WIZARD_MAZE)  // SPWI813.SPL (????????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_DOMINATION)  // SPWI506.SPL (??????????)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		DestroyItem("NWRZSEEV")  // ?????????? ??????
		Spell(LastSeenBy(Myself),WIZARD_DOMINATION)  // SPWI506.SPL (??????????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_EMOTION_HOPELESSNESS)  // SPWI411.SPL (??????)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(2)
		NumCreatureGT([GOODCUTOFF],1)
		CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(2)
		NumCreatureGT([GOODCUTOFF],1)
		CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	OR(5)
		!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		!CheckStat(LastSeenBy(Myself),0,SANCTUARY)
		!CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
		HasBounceEffects(LastSeenBy(Myself))
		!CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(2)
		!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
		NumCreatureGT([GOODCUTOFF],1)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_EMOTION_HOPELESSNESS)  // SPWI411.SPL (??????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_FEEBLEMIND)  // SPWI509.SPL (?????????)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	OR(2)
		!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
		NumCreatureGT([GOODCUTOFF],1)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		DestroyItem("NWRZSEEV")  // ?????????? ??????
		Spell(LastSeenBy(Myself),WIZARD_FEEBLEMIND)  // SPWI509.SPL (?????????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_HOLD_PERSON)  // SPWI306.SPL (????????? ?????????)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		DestroyItem("NWRZSEEV")  // ?????????? ??????
		Spell(LastSeenBy(Myself),WIZARD_HOLD_PERSON)  // SPWI306.SPL (????????? ?????????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_DIRE_CHARM)  // SPWI316.SPL (??????? ??????????)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		DestroyItem("NWRZSEEV")  // ?????????? ??????
		Spell(LastSeenBy(Myself),WIZARD_DIRE_CHARM)  // SPWI316.SPL (??????? ??????????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_FLAME_ARROW)  // SPWI303.SPL (????????? ??????)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		DestroyItem("NWRZSEEV")  // ?????????? ??????
		Spell(LastSeenBy(Myself),WIZARD_FLAME_ARROW)  // SPWI303.SPL (????????? ??????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_HORROR)  // SPWI205.SPL (????)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(2)
		NumCreatureGT([GOODCUTOFF],1)
		CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(2)
		NumCreatureGT([GOODCUTOFF],1)
		CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	OR(5)
		!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		!CheckStat(LastSeenBy(Myself),0,SANCTUARY)
		!CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
		HasBounceEffects(LastSeenBy(Myself))
		!CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(2)
		!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
		NumCreatureGT([GOODCUTOFF],1)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_HORROR)  // SPWI205.SPL (????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_MELF_ACID_ARROW)  // SPWI211.SPL (????????? ?????? ??????)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		DestroyItem("NWRZSEEV")  // ?????????? ??????
		Spell(LastSeenBy(Myself),WIZARD_MELF_ACID_ARROW)  // SPWI211.SPL (????????? ?????? ??????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_RAY_OF_ENFEEBLEMENT)  // SPWI221.SPL (??? ??????????)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		DestroyItem("NWRZSEEV")  // ?????????? ??????
		Spell(LastSeenBy(Myself),WIZARD_RAY_OF_ENFEEBLEMENT)  // SPWI221.SPL (??? ??????????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_CHARM_PERSON)  // SPWI104.SPL (?????????? ?????????)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		DestroyItem("NWRZSEEV")  // ?????????? ??????
		Spell(LastSeenBy(Myself),WIZARD_CHARM_PERSON)  // SPWI104.SPL (?????????? ?????????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_SPOOK)  // SPWI125.SPL (??????????)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		DestroyItem("NWRZSEEV")  // ?????????? ??????
		Spell(LastSeenBy(Myself),WIZARD_SPOOK)  // SPWI125.SPL (??????????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_BLINDNESS)  // SPWI106.SPL (??????????)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		DestroyItem("NWRZSEEV")  // ?????????? ??????
		Spell(LastSeenBy(Myself),WIZARD_BLINDNESS)  // SPWI106.SPL (??????????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_LARLOCH_MINOR_DRAIN)  // SPWI119.SPL (????? ????????? ???????)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("Action_Timer","LOCALS",ONE_ROUND)
		DestroyItem("NWRZSEEV")  // ?????????? ??????
		Spell(LastSeenBy(Myself),WIZARD_LARLOCH_MINOR_DRAIN)  // SPWI119.SPL (????? ????????? ???????)
	RESPONSE #50
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Run_Away_Timer","LOCALS")
	Global("Out_of_Spells","LOCALS",0)
	CheckStat(Myself,0,POLYMORPHED)
	Range(NearestEnemyOf(Myself),10)
	RandomNumGT(20,5)
THEN
	RESPONSE #100
		SetGlobalTimer("RZ_Run_To_Safety","LOCALS",3)
		SetGlobalTimer("RZ_Run_Away_Timer","LOCALS",TWO_ROUNDS)
		RunAwayFrom(NearestEnemyOf(Myself),45)
END

IF
	Global("Out_of_Spells","LOCALS",0)
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	OR(10)
		!StateCheck([GOODCUTOFF],STATE_DISABLED)
		!StateCheck(SecondNearest([GOODCUTOFF]),STATE_DISABLED)
		!StateCheck(ThirdNearest([GOODCUTOFF]),STATE_DISABLED)
		!StateCheck(FourthNearest([GOODCUTOFF]),STATE_DISABLED)
		!StateCheck(FifthNearest([GOODCUTOFF]),STATE_DISABLED)
		!StateCheck(SixthNearest([GOODCUTOFF]),STATE_DISABLED)
		!StateCheck(SeventhNearest([GOODCUTOFF]),STATE_DISABLED)
		!StateCheck(EighthNearest([GOODCUTOFF]),STATE_DISABLED)
		!StateCheck(NinthNearest([GOODCUTOFF]),STATE_DISABLED)
		!StateCheck(TenthNearest([GOODCUTOFF]),STATE_DISABLED)
THEN
	RESPONSE #100
END

IF
	GlobalTimerNotExpired("RZ_Run_To_Safety","LOCALS")
THEN
	RESPONSE #100
END

IF
	See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	See(NearestEnemyOf(Myself))
	OR(6)
		RandomNumGT(100,33)
		!See(LastAttackerOf(Myself))
		!Range(LastAttackerOf(Myself),15)
		!CheckStat(LastAttackerOf(Myself),0,SANCTUARY)
		StateCheck(LastAttackerOf(Myself),STATE_INVISIBLE)
		StateCheck(LastAttackerOf(Myself),STATE_DISABLED)
	OR(8)
		RandomNumGT(100,33)
		!Heard([ENEMY],HELP101)
		Range(LastHeardBy(Myself),0)
		!See(LastAttackerOf(LastHeardBy(Myself)))
		!Range(LastAttackerOf(LastHeardBy(Myself)),20)
		!CheckStat(LastAttackerOf(LastHeardBy(Myself)),0,SANCTUARY)
		StateCheck(LastAttackerOf(LastHeardBy(Myself)),STATE_INVISIBLE)
		StateCheck(LastAttackerOf(LastHeardBy(Myself)),STATE_DISABLED)
	OR(7)
		RandomNumGT(100,33)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,STONESKINS)
		StateCheck(MostDamagedOf([PC]),STATE_MIRRORIMAGE)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		!StateCheck(MostDamagedOf([PC]),STATE_IMMOBILE)
	OR(7)
		RandomNumGT(100,33)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,STONESKINS)
		StateCheck(MostDamagedOf([PC]),STATE_MIRRORIMAGE)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		CheckStat(MostDamagedOf([PC]),0,HELD)
	OR(7)
		RandomNumGT(100,33)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,STONESKINS)
		StateCheck(MostDamagedOf([PC]),STATE_MIRRORIMAGE)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		CheckStat(MostDamagedOf([PC]),0,CasterHold)
	OR(7)
		RandomNumGT(100,33)
		!See(StrongestOf([PC]))
		!CheckStat(StrongestOf([PC]),0,STONESKINS)
		StateCheck(StrongestOf([PC]),STATE_MIRRORIMAGE)
		!CheckStat(StrongestOf([PC]),0,SANCTUARY)
		StateCheck(StrongestOf([PC]),STATE_INVISIBLE)
		!StateCheck(StrongestOf([PC]),STATE_IMMOBILE)
	OR(7)
		RandomNumGT(100,33)
		!See(StrongestOf([PC]))
		!CheckStat(StrongestOf([PC]),0,STONESKINS)
		StateCheck(StrongestOf([PC]),STATE_MIRRORIMAGE)
		!CheckStat(StrongestOf([PC]),0,SANCTUARY)
		StateCheck(StrongestOf([PC]),STATE_INVISIBLE)
		CheckStat(StrongestOf([PC]),0,HELD)
	OR(7)
		RandomNumGT(100,33)
		!See(StrongestOf([PC]))
		!CheckStat(StrongestOf([PC]),0,STONESKINS)
		StateCheck(StrongestOf([PC]),STATE_MIRRORIMAGE)
		!CheckStat(StrongestOf([PC]),0,SANCTUARY)
		StateCheck(StrongestOf([PC]),STATE_INVISIBLE)
		CheckStat(StrongestOf([PC]),0,CasterHold)
	OR(7)
		RandomNumGT(100,33)
		!See(WeakestOf([PC]))
		!CheckStat(WeakestOf([PC]),0,STONESKINS)
		StateCheck(WeakestOf([PC]),STATE_MIRRORIMAGE)
		!CheckStat(WeakestOf([PC]),0,SANCTUARY)
		StateCheck(WeakestOf([PC]),STATE_INVISIBLE)
		!StateCheck(WeakestOf([PC]),STATE_IMMOBILE)
	OR(7)
		RandomNumGT(100,33)
		!See(WeakestOf([PC]))
		!CheckStat(WeakestOf([PC]),0,STONESKINS)
		StateCheck(WeakestOf([PC]),STATE_MIRRORIMAGE)
		!CheckStat(WeakestOf([PC]),0,SANCTUARY)
		StateCheck(WeakestOf([PC]),STATE_INVISIBLE)
		CheckStat(WeakestOf([PC]),0,HELD)
	OR(7)
		RandomNumGT(100,33)
		!See(WeakestOf([PC]))
		!CheckStat(WeakestOf([PC]),0,STONESKINS)
		StateCheck(WeakestOf([PC]),STATE_MIRRORIMAGE)
		!CheckStat(WeakestOf([PC]),0,SANCTUARY)
		StateCheck(WeakestOf([PC]),STATE_INVISIBLE)
		CheckStat(WeakestOf([PC]),0,CasterHold)
	OR(7)
		RandomNumGT(100,33)
		!See([PC])
		!CheckStat([PC],0,STONESKINS)
		StateCheck([PC],STATE_MIRRORIMAGE)
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_INVISIBLE)
		!StateCheck([PC],STATE_IMMOBILE)
	OR(7)
		RandomNumGT(100,33)
		!See([PC])
		!CheckStat([PC],0,STONESKINS)
		StateCheck([PC],STATE_MIRRORIMAGE)
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_INVISIBLE)
		CheckStat([PC],0,HELD)
	OR(7)
		RandomNumGT(100,33)
		!See([PC])
		!CheckStat([PC],0,STONESKINS)
		StateCheck([PC],STATE_MIRRORIMAGE)
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_INVISIBLE)
		CheckStat([PC],0,CasterHold)
	OR(7)
		RandomNumGT(100,33)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,STONESKINS)
		StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SecondNearest([PC]),STATE_IMMOBILE)
	OR(7)
		RandomNumGT(100,33)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,STONESKINS)
		StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		CheckStat(SecondNearest([PC]),0,HELD)
	OR(7)
		RandomNumGT(100,33)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,STONESKINS)
		StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		CheckStat(SecondNearest([PC]),0,CasterHold)
	OR(7)
		RandomNumGT(100,33)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,STONESKINS)
		StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		!StateCheck(ThirdNearest([PC]),STATE_IMMOBILE)
	OR(7)
		RandomNumGT(100,33)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,STONESKINS)
		StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		CheckStat(ThirdNearest([PC]),0,HELD)
	OR(7)
		RandomNumGT(100,33)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,STONESKINS)
		StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		CheckStat(ThirdNearest([PC]),0,CasterHold)
	OR(7)
		RandomNumGT(100,33)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,STONESKINS)
		StateCheck(FourthNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FourthNearest([PC]),STATE_IMMOBILE)
	OR(7)
		RandomNumGT(100,33)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,STONESKINS)
		StateCheck(FourthNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		CheckStat(FourthNearest([PC]),0,HELD)
	OR(7)
		RandomNumGT(100,33)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,STONESKINS)
		StateCheck(FourthNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		CheckStat(FourthNearest([PC]),0,CasterHold)
	OR(7)
		RandomNumGT(100,33)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,STONESKINS)
		StateCheck(FifthNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FifthNearest([PC]),STATE_IMMOBILE)
	OR(7)
		RandomNumGT(100,33)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,STONESKINS)
		StateCheck(FifthNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		CheckStat(FifthNearest([PC]),0,HELD)
	OR(7)
		RandomNumGT(100,33)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,STONESKINS)
		StateCheck(FifthNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		CheckStat(FifthNearest([PC]),0,CasterHold)
	OR(7)
		RandomNumGT(100,33)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,STONESKINS)
		StateCheck(SixthNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SixthNearest([PC]),STATE_IMMOBILE)
	OR(7)
		RandomNumGT(100,33)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,STONESKINS)
		StateCheck(SixthNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		CheckStat(SixthNearest([PC]),0,HELD)
	OR(7)
		RandomNumGT(100,33)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,STONESKINS)
		StateCheck(SixthNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		CheckStat(SixthNearest([PC]),0,CasterHold)
	OR(7)
		RandomNumGT(100,33)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,STONESKINS)
		StateCheck(MostDamagedOf([PC]),STATE_MIRRORIMAGE)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		StateCheck(MostDamagedOf([PC]),STATE_DISABLED)
	OR(7)
		RandomNumGT(100,33)
		!See(StrongestOf([PC]))
		!CheckStat(StrongestOf([PC]),0,STONESKINS)
		StateCheck(StrongestOf([PC]),STATE_MIRRORIMAGE)
		!CheckStat(StrongestOf([PC]),0,SANCTUARY)
		StateCheck(StrongestOf([PC]),STATE_INVISIBLE)
		StateCheck(StrongestOf([PC]),STATE_DISABLED)
	OR(7)
		RandomNumGT(100,33)
		!See(WeakestOf([PC]))
		!CheckStat(WeakestOf([PC]),0,STONESKINS)
		StateCheck(WeakestOf([PC]),STATE_MIRRORIMAGE)
		!CheckStat(WeakestOf([PC]),0,SANCTUARY)
		StateCheck(WeakestOf([PC]),STATE_INVISIBLE)
		StateCheck(WeakestOf([PC]),STATE_DISABLED)
	OR(7)
		RandomNumGT(100,25)
		!See([PC])
		!CheckStat([PC],0,STONESKINS)
		StateCheck([PC],STATE_MIRRORIMAGE)
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_DISABLED)
	OR(7)
		RandomNumGT(100,46)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,STONESKINS)
		StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(7)
		RandomNumGT(100,63)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,STONESKINS)
		StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(7)
		RandomNumGT(100,76)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,STONESKINS)
		StateCheck(FourthNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(7)
		RandomNumGT(100,85)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,STONESKINS)
		StateCheck(FifthNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(7)
		RandomNumGT(100,90)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,STONESKINS)
		StateCheck(SixthNearest([PC]),STATE_MIRRORIMAGE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(6)
		RandomNumGT(100,33)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,STONESKINS)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		!StateCheck(MostDamagedOf([PC]),STATE_IMMOBILE)
	OR(6)
		RandomNumGT(100,33)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,STONESKINS)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		CheckStat(MostDamagedOf([PC]),0,HELD)
	OR(6)
		RandomNumGT(100,33)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,STONESKINS)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		CheckStat(MostDamagedOf([PC]),0,CasterHold)
	OR(6)
		RandomNumGT(100,33)
		!See(StrongestOf([PC]))
		!CheckStat(StrongestOf([PC]),0,STONESKINS)
		!CheckStat(StrongestOf([PC]),0,SANCTUARY)
		StateCheck(StrongestOf([PC]),STATE_INVISIBLE)
		!StateCheck(StrongestOf([PC]),STATE_IMMOBILE)
	OR(6)
		RandomNumGT(100,33)
		!See(StrongestOf([PC]))
		!CheckStat(StrongestOf([PC]),0,STONESKINS)
		!CheckStat(StrongestOf([PC]),0,SANCTUARY)
		StateCheck(StrongestOf([PC]),STATE_INVISIBLE)
		CheckStat(StrongestOf([PC]),0,HELD)
	OR(6)
		RandomNumGT(100,33)
		!See(StrongestOf([PC]))
		!CheckStat(StrongestOf([PC]),0,STONESKINS)
		!CheckStat(StrongestOf([PC]),0,SANCTUARY)
		StateCheck(StrongestOf([PC]),STATE_INVISIBLE)
		CheckStat(StrongestOf([PC]),0,CasterHold)
	OR(6)
		RandomNumGT(100,33)
		!See(WeakestOf([PC]))
		!CheckStat(WeakestOf([PC]),0,STONESKINS)
		!CheckStat(WeakestOf([PC]),0,SANCTUARY)
		StateCheck(WeakestOf([PC]),STATE_INVISIBLE)
		!StateCheck(WeakestOf([PC]),STATE_IMMOBILE)
	OR(6)
		RandomNumGT(100,33)
		!See(WeakestOf([PC]))
		!CheckStat(WeakestOf([PC]),0,STONESKINS)
		!CheckStat(WeakestOf([PC]),0,SANCTUARY)
		StateCheck(WeakestOf([PC]),STATE_INVISIBLE)
		CheckStat(WeakestOf([PC]),0,HELD)
	OR(6)
		RandomNumGT(100,33)
		!See(WeakestOf([PC]))
		!CheckStat(WeakestOf([PC]),0,STONESKINS)
		!CheckStat(WeakestOf([PC]),0,SANCTUARY)
		StateCheck(WeakestOf([PC]),STATE_INVISIBLE)
		CheckStat(WeakestOf([PC]),0,CasterHold)
	OR(6)
		RandomNumGT(100,33)
		!See([PC])
		!CheckStat([PC],0,STONESKINS)
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_INVISIBLE)
		!StateCheck([PC],STATE_IMMOBILE)
	OR(6)
		RandomNumGT(100,33)
		!See([PC])
		!CheckStat([PC],0,STONESKINS)
		!CheckStat(Nearest([PC]),0,SANCTUARY)
		StateCheck(Nearest([PC]),STATE_INVISIBLE)
		CheckStat([PC],0,HELD)
	OR(6)
		RandomNumGT(100,33)
		!See([PC])
		!CheckStat([PC],0,STONESKINS)
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_INVISIBLE)
		CheckStat([PC],0,CasterHold)
	OR(6)
		RandomNumGT(100,33)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,STONESKINS)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SecondNearest([PC]),STATE_IMMOBILE)
	OR(6)
		RandomNumGT(100,33)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,STONESKINS)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		CheckStat(SecondNearest([PC]),0,HELD)
	OR(6)
		RandomNumGT(100,33)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,STONESKINS)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		CheckStat(SecondNearest([PC]),0,CasterHold)
	OR(6)
		RandomNumGT(100,33)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,STONESKINS)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		!StateCheck(ThirdNearest([PC]),STATE_IMMOBILE)
	OR(6)
		RandomNumGT(100,33)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,STONESKINS)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		CheckStat(ThirdNearest([PC]),0,HELD)
	OR(6)
		RandomNumGT(100,33)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,STONESKINS)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		CheckStat(ThirdNearest([PC]),0,CasterHold)
	OR(6)
		RandomNumGT(100,33)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,STONESKINS)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FourthNearest([PC]),STATE_IMMOBILE)
	OR(6)
		RandomNumGT(100,33)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,STONESKINS)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		CheckStat(FourthNearest([PC]),0,HELD)
	OR(6)
		RandomNumGT(100,33)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,STONESKINS)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		CheckStat(FourthNearest([PC]),0,CasterHold)
	OR(6)
		RandomNumGT(100,33)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,STONESKINS)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FifthNearest([PC]),STATE_IMMOBILE)
	OR(6)
		RandomNumGT(100,33)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,STONESKINS)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		CheckStat(FifthNearest([PC]),0,HELD)
	OR(6)
		RandomNumGT(100,33)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,STONESKINS)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		CheckStat(FifthNearest([PC]),0,CasterHold)
	OR(6)
		RandomNumGT(100,33)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,STONESKINS)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SixthNearest([PC]),STATE_IMMOBILE)
	OR(6)
		RandomNumGT(100,33)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,STONESKINS)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		CheckStat(SixthNearest([PC]),0,HELD)
	OR(6)
		RandomNumGT(100,33)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,STONESKINS)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		CheckStat(SixthNearest([PC]),0,CasterHold)
	OR(6)
		RandomNumGT(100,33)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,STONESKINS)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		StateCheck(MostDamagedOf([PC]),STATE_DISABLED)
	OR(6)
		RandomNumGT(100,33)
		!See(StrongestOf([PC]))
		!CheckStat(StrongestOf([PC]),0,STONESKINS)
		!CheckStat(StrongestOf([PC]),0,SANCTUARY)
		StateCheck(StrongestOf([PC]),STATE_INVISIBLE)
		StateCheck(StrongestOf([PC]),STATE_DISABLED)
	OR(6)
		RandomNumGT(100,33)
		!See(WeakestOf([PC]))
		!CheckStat(WeakestOf([PC]),0,STONESKINS)
		!CheckStat(WeakestOf([PC]),0,SANCTUARY)
		StateCheck(WeakestOf([PC]),STATE_INVISIBLE)
		StateCheck(WeakestOf([PC]),STATE_DISABLED)
	OR(6)
		RandomNumGT(100,25)
		!See([PC])
		!CheckStat([PC],0,STONESKINS)
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_DISABLED)
	OR(6)
		RandomNumGT(100,46)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,STONESKINS)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(6)
		RandomNumGT(100,63)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,STONESKINS)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(6)
		RandomNumGT(100,76)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,STONESKINS)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(6)
		RandomNumGT(100,85)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,STONESKINS)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(6)
		RandomNumGT(100,90)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,STONESKINS)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(5)
		RandomNumGT(100,33)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		!StateCheck(MostDamagedOf([PC]),STATE_IMMOBILE)
	OR(5)
		RandomNumGT(100,33)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		CheckStat(MostDamagedOf([PC]),0,HELD)
	OR(5)
		RandomNumGT(100,33)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		CheckStat(MostDamagedOf([PC]),0,CasterHold)
	OR(5)
		RandomNumGT(100,33)
		!See(StrongestOf([PC]))
		!CheckStat(StrongestOf([PC]),0,SANCTUARY)
		StateCheck(StrongestOf([PC]),STATE_INVISIBLE)
		!StateCheck(StrongestOf([PC]),STATE_IMMOBILE)
	OR(5)
		RandomNumGT(100,33)
		!See(StrongestOf([PC]))
		!CheckStat(StrongestOf([PC]),0,SANCTUARY)
		StateCheck(StrongestOf([PC]),STATE_INVISIBLE)
		CheckStat(StrongestOf([PC]),0,HELD)
	OR(5)
		RandomNumGT(100,33)
		!See(StrongestOf([PC]))
		!CheckStat(StrongestOf([PC]),0,SANCTUARY)
		StateCheck(StrongestOf([PC]),STATE_INVISIBLE)
		CheckStat(StrongestOf([PC]),0,CasterHold)
	OR(5)
		RandomNumGT(100,33)
		!See(WeakestOf([PC]))
		!CheckStat(WeakestOf([PC]),0,SANCTUARY)
		StateCheck(WeakestOf([PC]),STATE_INVISIBLE)
		!StateCheck(WeakestOf([PC]),STATE_IMMOBILE)
	OR(5)
		RandomNumGT(100,33)
		!See(WeakestOf([PC]))
		!CheckStat(WeakestOf([PC]),0,SANCTUARY)
		StateCheck(WeakestOf([PC]),STATE_INVISIBLE)
		CheckStat(WeakestOf([PC]),0,HELD)
	OR(5)
		RandomNumGT(100,33)
		!See(WeakestOf([PC]))
		!CheckStat(WeakestOf([PC]),0,SANCTUARY)
		StateCheck(WeakestOf([PC]),STATE_INVISIBLE)
		CheckStat(WeakestOf([PC]),0,CasterHold)
	OR(5)
		RandomNumGT(100,33)
		!See([PC])
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_INVISIBLE)
		!StateCheck([PC],STATE_IMMOBILE)
	OR(5)
		RandomNumGT(100,33)
		!See([PC])
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_INVISIBLE)
		CheckStat([PC],0,HELD)
	OR(5)
		RandomNumGT(100,33)
		!See([PC])
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_INVISIBLE)
		CheckStat([PC],0,CasterHold)
	OR(5)
		RandomNumGT(100,33)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SecondNearest([PC]),STATE_IMMOBILE)
	OR(5)
		RandomNumGT(100,33)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		CheckStat(SecondNearest([PC]),0,HELD)
	OR(5)
		RandomNumGT(100,33)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		CheckStat(SecondNearest([PC]),0,CasterHold)
	OR(5)
		RandomNumGT(100,33)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		!StateCheck(ThirdNearest([PC]),STATE_IMMOBILE)
	OR(5)
		RandomNumGT(100,33)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		CheckStat(ThirdNearest([PC]),0,HELD)
	OR(5)
		RandomNumGT(100,33)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		CheckStat(ThirdNearest([PC]),0,CasterHold)
	OR(5)
		RandomNumGT(100,33)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FourthNearest([PC]),STATE_IMMOBILE)
	OR(5)
		RandomNumGT(100,33)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		CheckStat(FourthNearest([PC]),0,HELD)
	OR(5)
		RandomNumGT(100,33)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		CheckStat(FourthNearest([PC]),0,CasterHold)
	OR(5)
		RandomNumGT(100,33)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FifthNearest([PC]),STATE_IMMOBILE)
	OR(5)
		RandomNumGT(100,33)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		CheckStat(FifthNearest([PC]),0,HELD)
	OR(5)
		RandomNumGT(100,33)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		CheckStat(FifthNearest([PC]),0,CasterHold)
	OR(5)
		RandomNumGT(100,33)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SixthNearest([PC]),STATE_IMMOBILE)
	OR(5)
		RandomNumGT(100,33)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		CheckStat(SixthNearest([PC]),0,HELD)
	OR(5)
		RandomNumGT(100,33)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		CheckStat(SixthNearest([PC]),0,CasterHold)
	OR(5)
		RandomNumGT(100,33)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		StateCheck(MostDamagedOf([PC]),STATE_DISABLED)
	OR(5)
		RandomNumGT(100,33)
		!See(StrongestOf([PC]))
		!CheckStat(StrongestOf([PC]),0,SANCTUARY)
		StateCheck(StrongestOf([PC]),STATE_INVISIBLE)
		StateCheck(StrongestOf([PC]),STATE_DISABLED)
	OR(5)
		RandomNumGT(100,33)
		!See(WeakestOf([PC]))
		!CheckStat(WeakestOf([PC]),0,SANCTUARY)
		StateCheck(WeakestOf([PC]),STATE_INVISIBLE)
		StateCheck(WeakestOf([PC]),STATE_DISABLED)
	OR(5)
		RandomNumGT(100,25)
		!See([PC])
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_DISABLED)
	OR(5)
		RandomNumGT(100,46)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_DISABLED)
	OR(5)
		RandomNumGT(100,63)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_DISABLED)
	OR(5)
		RandomNumGT(100,76)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_DISABLED)
	OR(5)
		RandomNumGT(100,85)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_DISABLED)
	OR(5)
		RandomNumGT(100,90)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_DISABLED)
	OR(4)
		RandomNumGT(100,25)
		!See([PC])
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_INVISIBLE)
	OR(4)
		RandomNumGT(100,46)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
	OR(4)
		RandomNumGT(100,63)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
	OR(4)
		RandomNumGT(100,76)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
	OR(4)
		RandomNumGT(100,85)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
	OR(4)
		RandomNumGT(100,90)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
	OR(3)
		!See([PC])
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],STATE_INVISIBLE)
	OR(3)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
	OR(3)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
	OR(3)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
	OR(3)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
	OR(3)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
	OR(3)
		!See(NearestEnemyOf(Myself))
		!CheckStat(NearestEnemyOf(Myself),0,SANCTUARY)
		StateCheck(NearestEnemyOf(Myself),STATE_INVISIBLE)
	OR(3)
		!See(SecondNearestEnemyOf(Myself))
		!CheckStat(SecondNearestEnemyOf(Myself),0,SANCTUARY)
		StateCheck(SecondNearestEnemyOf(Myself),STATE_INVISIBLE)
	OR(3)
		!See(ThirdNearestEnemyOf(Myself))
		!CheckStat(ThirdNearestEnemyOf(Myself),0,SANCTUARY)
		StateCheck(ThirdNearestEnemyOf(Myself),STATE_INVISIBLE)
	OR(3)
		!See(FourthNearestEnemyOf(Myself))
		!CheckStat(FourthNearestEnemyOf(Myself),0,SANCTUARY)
		StateCheck(FourthNearestEnemyOf(Myself),STATE_INVISIBLE)
	OR(3)
		!See(FifthNearestEnemyOf(Myself))
		!CheckStat(FifthNearestEnemyOf(Myself),0,SANCTUARY)
		StateCheck(FifthNearestEnemyOf(Myself),STATE_INVISIBLE)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!RandomNum(21,6)
	OR(3)
		ActionListEmpty()
		!Global("Out_of_Spells","LOCALS",0)
		!CheckStat(Myself,0,POLYMORPHED)
	OR(3)
		!StateCheck(Myself,STATE_INVISIBLE)
		!Global("Out_of_Spells","LOCALS",0)
		!CheckStat(Myself,0,POLYMORPHED)
	See(LastSeenBy(Myself))
	OR(2)
		Allegiance(LastSeenBy(Myself),PC)
		CheckStatLT(LastSeenBy(Myself),75,RESISTSLASHING)
	OR(8)
		Range(LastSeenBy(Myself),6)
		!Global("Out_of_Spells","LOCALS",0)
		!CheckStat(Myself,0,POLYMORPHED)
		StateCheck(LastSeenBy(Myself),STATE_IMMOBILE)
		!CheckStat(LastSeenBy(Myself),0,CasterHold)
		!CheckStat(LastSeenBy(Myself),0,HELD)
		!CheckStatLT(Myself,34,SPELLFAILUREMAGE)
		StateCheck(Myself,STATE_SILENCED)
	OR(6)
		NumCreature([GOODCUTOFF],1)
		Range(LastSeenBy(Myself),15)
		!CheckStat(Myself,0,POLYMORPHED)
		!CheckStatLT(Myself,34,SPELLFAILUREMAGE)
		StateCheck(Myself,STATE_SILENCED)
		!Global("Out_of_Spells","LOCALS",0)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		AttackReevaluate(LastSeenBy(Myself),45)
END

IF
	ActionListEmpty()
THEN
	RESPONSE #100
		RandomWalk()
END

